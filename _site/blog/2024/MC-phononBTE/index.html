<!DOCTYPE html>
<html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Metadata, OpenGraph and Schema.org -->




<!-- Standard metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">




<title>
  
    
    
      Theoretical framework for phonon Monte Carlo simulations | Shixian Liu
    
  
</title>
<meta name="author" content="Shixian Liu">
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.">

  <meta name="keywords" content="thermophysics, phonon, heat transfer">










<!-- Bootstrap & MDB -->
<link rel="stylesheet" href="/assets/css/bootstrap.min.css?41faab39e5144b07a9384ecf47eac8c3">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

<!-- Bootstrap Table -->


<!-- Fonts & Icons -->
<link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5">
<link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772">
<link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap">

<!-- Code Syntax Highlighting -->
<link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light">



<!-- Styles -->

<!-- pseudocode -->



  <link rel="shortcut icon" href="/assets/img/sheng.png?999c12785eb719d4b77e851bbb1bffbc">

<link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
<link rel="canonical" href="https://lyushisyan.github.io/blog/2024/MC-phononBTE/">

<!-- Dark Mode -->
<script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script>

  <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark">
  <script>
    initTheme();
  </script>


<!-- GeoJSON support via Leaflet -->

  <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" integrity="sha256-q9ba7o845pMPFU+zcAll8rv+gC+fSovKsOoNQ6cynuQ=" crossorigin="anonymous">


<!-- diff2html -->






    
      <!-- Medium Zoom JS -->
      <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
      <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script>
    
    <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    
  
    <!-- MathJax -->
    <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        tags: 'ams',
      }
    };
    </script>
    <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script>
  


    

    

    
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js" integrity="sha256-MgH13bFTTNqsnuEoqNPBLDaqxjGH+lCpqrukmXc8Ppg=" crossorigin="anonymous"></script>
  <script>
    /* Create leaflet map as another node and hide the code block, appending the leaflet node after it */
    document.addEventListener('readystatechange', () => {
      if (document.readyState === 'complete') {
        document.querySelectorAll('pre>code.language-geojson').forEach((elem) => {
          const jsonData = elem.textContent;
          const backup = elem.parentElement;
          backup.classList.add('unloaded');
          /* create leaflet node */
          let mapElement = document.createElement('div');
          mapElement.classList.add('map');
          backup.after(mapElement);

          var map = L.map(mapElement);
          L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
          }).addTo(map);
          let geoJSON = L.geoJSON(JSON.parse(jsonData)).addTo(map);
          map.fitBounds(geoJSON.getBounds());
        });
      }
    });
  </script>


    

    

    

    

    

    

  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script>



<!-- Bootstrap Table -->


<!-- Load Common JS -->
<script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script>
<script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script>
<script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script>

<!-- Jupyter Open External Links New Tab -->
<script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script>



    

    <!-- Distill js -->
    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    <script src="/assets/js/distillpub/overrides.js"></script>
    
  </head>

  <body>
<d-front-matter>
    <script async type="text/json">
      {
            "title": "Theoretical framework for phonon Monte Carlo simulations",
            "description": "",
            "published": "November 16, 2024",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script>
  </d-front-matter>

  
    <!-- Header -->
    <header>
  <!-- Nav Bar -->
  <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation">
    <div class="container">
      
        <a class="navbar-brand title font-weight-lighter" href="/">
          
            
              <span class="font-weight-bold">Shixian</span>
            
            
            Liu
          
        </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>

      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          

          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">Home
              
            </a>
          </li>

          <!-- Other pages -->
          
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
              
                
                <li class="nav-item active">
                  <a class="nav-link" href="/blog/">Blog
                    
                      <span class="sr-only">(current)</span>
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/publications/">Publications
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/teaching/">Teaching
                    
                  </a>
                </li>
              
            
          
          
            <!-- Search -->
            <li class="nav-item">
              <button id="search-toggle" title="Search" onclick="openSearchModal()">
                <span class="nav-link">ctrl k <i class="ti ti-search"></i></span>
              </button>
            </li>
          
          <!-- Toogle language -->
          
            
              
              <li class="nav-item active">
                
                  <a class="nav-link" href="/zh-CN/blog/2024/MC-phononBTE/">
                    
                      ZH-CN</a>
                
              </li>
            
          
          
            <!-- Toogle theme mode -->
            <li class="toggle-container">
              <button id="light-toggle" title="Change theme">
                <i class="ti ti-sun-moon" id="light-toggle-system"></i>
                <i class="ti ti-moon-filled" id="light-toggle-dark"></i>
                <i class="ti ti-sun-filled" id="light-toggle-light"></i>
              </button>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
  
    <!-- Scrolling Progress Bar -->
    <progress id="progress" value="0">
      <div class="progress-container">
        <span class="progress-bar"></span>
      </div>
    </progress>
  
</header>


    <!-- Content -->
    <div class="post distill">
    <d-title>
      <h1 style="
        font-size: 1.8rem;
        font-weight: 600;
        text-align: center;
        overflow: hidden;
        margin-top: 0.2em;
        margin-bottom: 0.1em;
        text-overflow: ellipsis;
      ">
        Theoretical framework for phonon Monte Carlo simulations
      </h1>
      <p></p>
    </d-title>
      

      <d-article>
        
          <d-contents>
            <nav class="l-text figcaption">
              <h3>Contents</h3>
              
                <div>
                  <a href="#1-boltzmann-transport-equation">1. Boltzmann Transport Equation</a>
                </div>
                
              
                <div>
                  <a href="#2-monte-carlo-simulation-algorithm">2. Monte Carlo Simulation Algorithm</a>
                </div>
                
              
                <div>
                  <a href="#3-setting-boundary-conditions">3. Setting Boundary Conditions</a>
                </div>
                
              
            </nav>
          </d-contents>
        
        <h2 id="1-boltzmann-transport-equation">1. Boltzmann Transport Equation</h2>

<h3 id="11-particle-based-boltzmann-transport-equation">1.1 Particle-Based Boltzmann Transport Equation:</h3>

\[\frac{\partial f}{\partial t} + \boldsymbol v_g(\omega,p)\nabla f = - \frac{f-f^{\text{loc}}}{\tau(\omega,p,T)}\]

<p>where $f=f(t,\boldsymbol x,\boldsymbol k,p)$ is the phonon distribution function in phase space, $\omega=\omega(\boldsymbol k,p)$ is the phonon angular frequency, $p$ is phonon polarization, and $T$ is temperature. Moreover, $f^\text{loc}$ is the BE equilibrium distribution parameterized by a local pseudo-temperature.</p>

<p>Using phonon bundles to represent simulated particles:</p>

\[f(t,\boldsymbol x,\boldsymbol k,p) \approx 8\pi^3N_\text{eff}\sum_i \delta^3(\boldsymbol x - \boldsymbol x_i) \delta^3(\boldsymbol k - \boldsymbol k_i) \delta_{p,p_i}\]

<p>where $N_\text{eff}$ is the effective number of phonons in each phonon bundle.</p>

<h3 id="12-energy-based-boltzmann-transport-equation-energy-based-bte">1.2 Energy-Based Boltzmann Transport Equation (Energy-Based BTE):</h3>

\[\frac{\partial e}{\partial t} + \boldsymbol v_g\nabla e = - \frac{e-e^{\text{loc}}}{\tau}\]

<p>Here, simulated particles represent energy $e=\hbar\omega f$, and $e^\text{loc}=\hbar\omega f^\text{loc}$.</p>

\[e \approx 8\pi^3\varepsilon_\text{eff}\sum_i \delta^3(\boldsymbol x - \boldsymbol x_i) \delta^3(\boldsymbol k - \boldsymbol k_i) \delta_{p,p_i}\]

<p>where $\varepsilon_\text{eff}$ is defined as the effective energy carried by each simulated particle, $\varepsilon_\text{eff}=N_\text{eff}\hbar\omega$. The effective number of phonons represented by the energy particle $\varepsilon_\text{eff}$ is variable.</p>

<h3 id="13-deviational-energy-based-boltzmann-transport-equation-deviational-energy-based-bte">1.3 Deviational Energy-Based Boltzmann Transport Equation (Deviational Energy-Based BTE):</h3>

\[\frac{\partial e^d}{\partial t} + \boldsymbol v_g\nabla e^d = \frac{(e^{\text{loc}}-e^{\text{eq}}_{T_\text{eq}})-e^d}{\tau}\]

<p>where,</p>

\[e^{\text{eq}}_{T_\text{eq}}(\omega) = \frac{\hbar\omega}{\exp\left(\frac{\hbar\omega}{k_BT_\text{eq}}\right)-1}\]

<p>Here, simulated particles represent deviational energy: $e^d = e - e^{\text{eq}}<em>{T</em>\text{eq}}$.</p>

\[e^d \approx 8\pi^3\varepsilon_\text{eff}^d\sum_i s(i) \delta^3(\boldsymbol x - \boldsymbol x_i) \delta^3(\boldsymbol k - \boldsymbol k_i) \delta_{p,p_i}\]

<p>$s(i)=+1$ represents a share of deviational energy increase relative to the reference state (the “excess” phonon group in higher-temperature regions).</p>

<p>$s(i)=-1$ represents a share of deviational energy decrease relative to the reference state (the “deficient” phonon group in lower-temperature regions).</p>

<div class="row">
    <div class="col-md-6 text-center">
        



<figure>
  <picture>
    <!-- Auto scaling with imagemagick -->
    <!--
      See https://www.debugbear.com/blog/responsive-images#w-descriptors-and-the-sizes-attribute and
      https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images for info on defining 'sizes' for responsive images
    -->
    
      <source class="responsive-img-srcset" srcset="/assets/img/blog/detaE-480.webp 480w,/assets/img/blog/detaE-800.webp 800w,/assets/img/blog/detaE-1400.webp 1400w," type="image/webp" sizes="95vw"></source>
    
    <img src="/assets/img/blog/detaE.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

  
</figure>

    </div>
</div>

<p>The deviational energy method focuses calculations on the non-equilibrium energy deviations by introducing a reference equilibrium temperature $T_\text{eq}$, rather than the full phonon distribution function. This reduces the simulation of large numbers of equilibrium phonons, significantly improving simulation efficiency, especially in cases of small temperature differences or near-equilibrium states.</p>

<p>In the deviational energy method, the number and sign (positive or negative) of simulated particles directly correspond to changes in deviational energy, reducing energy errors during particle addition or removal. Moreover, the computation inherently follows the principle of energy conservation.</p>

<h2 id="2-monte-carlo-simulation-algorithm">2. Monte Carlo Simulation Algorithm</h2>

<h3 id="21-particle-based-simulation">2.1 Particle-Based Simulation</h3>

<h3 id="initialization"><strong>Initialization:</strong></h3>

<p>At the initial temperature $T$, use BE statistics to calculate the number of phonons in volume $V$:</p>

\[N=V\int_{\omega=0}^{\omega_\text{max}}\sum_p D(\omega,p) f_T^\text{eq}(\omega) d\omega\]

<p>The number of simulated particles (each representing a phonon bundle) is given by $N/N_\text{eff}$.</p>

<p>The value of $N_\text{eff}$ is determined by balancing computational cost and the number of particles needed to obtain statistically meaningful results.</p>

<h3 id="time-evolution"><strong>Time Evolution:</strong></h3>

<p>After system initialization, the simulation is performed using a time-stepping algorithm with time step $\Delta t$.
Each time step consists of three substeps:</p>

<p>1). <strong>Phonon Drift</strong></p>

<p>During this period, simulated particle $i$ moves $\boldsymbol v_{g,i}\Delta t$.</p>

<p>2). <strong>Sampling</strong></p>

<p>Record temperature ($T$) and pseudo-temperature ($T_\text{loc}$), which are computed by inverting the energy ($E$) and pseudo-energy ($\widetilde E$) relations:</p>

\[E=N_\text{eff}\sum_i\hbar\omega_i=V\int_{\omega=0}^{\omega_\text{max}}\sum_p \frac{D(\omega,p) \hbar\omega}{\exp\left(\frac{\hbar\omega}{k_BT}\right)-1} d\omega\]

\[\widetilde E=N_\text{eff}\sum_i\frac{\hbar\omega_i}{\tau(\omega_i,p_i,T)}=V\int_{\omega=0}^{\omega_\text{max}}\sum_p \frac{D(\omega,p) \hbar\omega}{\tau(\omega,p,T)}\frac{1}{\exp\left(\frac{\hbar\omega}{k_BT_\text{loc}}\right)-1} d\omega\]

<p>Temperature ($T$) represents the average temperature in thermal equilibrium, while pseudo-temperature ($T_\text{loc}$) is related to phonon scattering processes and used to analyze phonon behavior in non-equilibrium states.</p>

<p>3). <strong>Phonon Scatter</strong></p>

<p>Perform scattering based on the scattering probability:</p>

\[P_i = 1-\exp\left(-\frac{\Delta t}{\tau(\omega_i,p_i,T)}\right)\]

<p>Scattering is performed by sampling new frequencies, polarizations, and propagation directions. The post-scattering frequencies must be drawn from the distribution $D(\omega,p)f^\text{loc}/\tau(\omega,p,T)$.</p>

<p>During scattering, energy conservation must be ensured. However, since the frequency of scattered phonons is randomly sampled, particles need to be added or removed to approximate the target energy, enforcing energy conservation.</p>

<p>This method does not always guarantee energy conservation, causing the system’s energy to drift randomly and introducing deterministic errors.</p>

<h3 id="22-energy-based-simulation">2.2 Energy-Based Simulation</h3>

<p>Using energy as the simulated particle, the algorithm is similar to the above but requires the following adjustments:</p>

<ol>
  <li>During initialization, boundary emission, or scattering, the sampling of frequency distribution must include a correction factor $\hbar\omega$.</li>
  <li>Calculating energy within a grid is straightforward: simply count the number of particles. The energy of $N$ particles is given by $\varepsilon_\text{eff} N$.</li>
  <li>Since the energy within the grid is proportional to the number of particles, no addition or deletion process is needed: simply conserving the number of particles ensures strict energy conservation.</li>
</ol>

<h3 id="23-deviational-energy-based-simulation">2.3 Deviational Energy-Based Simulation</h3>

<h3 id="initialization-1"><strong>Initialization:</strong></h3>

<p>First, select the equilibrium state at temperature $T_\text{eq}$ as the reference.</p>

<p>If the initial state $f^0$ matches the equilibrium distribution, no particles exist at the start of the simulation. The system’s deviational energy can be estimated based on the maximum temperature deviation:</p>

\[\Delta E = \int_{\omega=0}^{\omega_\text{max}}\sum_p\hbar\omega D(\omega,p)\times \bigg|\frac{1}{\exp(\frac{\hbar\omega}{k_BT})-1}-\frac{1}{\exp(\frac{\hbar\omega}{k_BT_\text{eq}})-1}\bigg| d\omega\]

<p>The effective deviational energy $\varepsilon_\text{eff}^d$ can be roughly determined based on the desired number of simulated particles.</p>

<p>If the initial state $f^0$ differs from the equilibrium distribution, particles must be initialized. Their frequencies and polarizations are drawn from the distribution:</p>

\[D(\omega,p)e^d(\omega) = \hbar\omega D(\omega,p)\bigg[f^0-\frac{1}{\exp(\frac{\hbar\omega}{k_BT_\text{eq}})-1}\bigg]\]

<p>Typically, $f^0$ is an equilibrium distribution at some temperature $T$, simplifying the above expression to:</p>

\[D(\omega,p)e^d(\omega) = \hbar\omega D(\omega,p)\bigg[\frac{1}{\exp(\frac{\hbar\omega}{k_BT})-1}-\frac{1}{\exp(\frac{\hbar\omega}{k_BT_\text{eq}})-1}\bigg]\]

<p>If $T &gt; T_\text{eq}$, this function is positive; if $T &lt; T_\text{eq}$, it is negative. In the latter case, particles are assigned a negative sign.</p>

<p>Frequency sampling: By subdividing the frequency range into bins, define a discretized and normalized cumulative distribution according to the above equation. Uniformly draw a random number between 0 and 1, and use it to find the corresponding bin in the normalized cumulative distribution.</p>

<h3 id="time-evolution-1"><strong>Time Evolution:</strong></h3>

<p><strong>(1) Phonon Drift:</strong></p>

<p>During the time step $\Delta t$, simulated particle $i$ moves $\boldsymbol v_{g,i}\Delta t$.</p>

<p><strong>(2) Sampling:</strong></p>

<p>(a) Let $C_j$ denote the set of particle indices in volume $V_j$ of cell $j$ at time $t$. Since each particle represents the same amount of energy, the deviational energy is:</p>

\[\Delta E_j = \varepsilon_\text{eff}^d \sum_{i\in C_j} s(i) = \varepsilon_\text{eff}^d (N_j^+ - N_j^-)\]

<p>where $N_j^+$ and $N_j^-$ are the numbers of positive and negative particles in cell $j$, respectively.</p>

<p>(b) The corresponding temperature $T_j$ is calculated by numerically inverting the equation:</p>

\[\frac{\Delta E_j}{V_j} = \int_0^{\omega_\text{max}}\sum_p D(\omega,p)\hbar\omega \bigg[\frac{1}{\exp(\frac{\hbar\omega}{k_BT_j})-1} - \frac{1}{\exp(\frac{\hbar\omega}{k_BT_\text{eq}})-1} \bigg] d\omega\]

<p>(c) The pseudo-temperature $[T_\text{loc}]_j$ is calculated by numerically inverting:</p>

\[\frac{\Delta \widetilde E_j}{V_j} = \int_0^{\omega_\text{max}}\sum_p \frac{D(\omega,p)\hbar\omega}{\tau(\omega,p,T_j)} \bigg[\frac{1}{\exp(\frac{\hbar\omega}{k_B[T_\text{loc}]_j})-1} - \frac{1}{\exp(\frac{\hbar\omega}{k_BT_\text{eq}})-1} \bigg] d\omega\]

\[\Delta\widetilde E_j = \varepsilon^d_\text{eff} \sum_{i\in C_j}\frac{s(i)}{\tau(\omega_i,p_i,T_j)}\]

<p><strong>(3) Phonon Scatter:</strong></p>

<p>Determine whether each phonon undergoes scattering based on the probability:</p>

\[P(\omega_i, p_i, T_j) = 1 - \exp\left(-\frac{\Delta t}{\tau(\omega_i, p_i, T_j)}\right)\]

<p>Scattered phonons are replaced with new particles, whose attributes (frequency and polarization) are drawn from:</p>

\[\frac{D(\omega, p)(e^\text{loc} - e^\text{eq}_{T_\text{eq}})}{\tau(\omega, p, T_j)} = \frac{D(\omega, p)\hbar\omega}{\tau(\omega, p, T_j)} \bigg[\frac{1}{\exp\left(\frac{\hbar\omega}{k_B [T_\text{loc}]_j}\right) - 1} - \frac{1}{\exp\left(\frac{\hbar\omega}{k_B T_\text{eq}}\right) - 1} \bigg]\]

<h2 id="3-setting-boundary-conditions">3. Setting Boundary Conditions</h2>

<p>In phonon transport problems, various types of boundary conditions can arise: adiabatic boundaries, isothermal boundaries, and periodic boundaries.</p>

<h3 id="31-adiabatic-boundary">3.1 Adiabatic Boundary</h3>

<p>Adiabatic boundaries reflect all incident phonons. This reflection process can be divided into two main categories: diffuse reflection and specular reflection.</p>

<p>In both cases, it is assumed that the polarization and frequency of phonons remain unchanged upon reflection. The only parameter modified during this process is the direction of propagation.</p>

<p>(i) Specular reflection ensures energy conservation, $e^d(\boldsymbol x, \boldsymbol k) = e^d(\boldsymbol x, \boldsymbol k’)$, with the direction given by:</p>

\[\boldsymbol k' = \boldsymbol k - 2(\boldsymbol k \cdot \boldsymbol n) \boldsymbol n\]

<p>where $\boldsymbol n$ is the normal vector of the boundary.</p>

<p>(ii) Diffuse reflection randomizes the reflection direction of phonons incident on the boundary, similar to how scattered phonons are treated.</p>

<p>Specular reflection occurs when the boundary is very smooth (relative to the phonon wavelength), meaning the surface roughness of the boundary is much smaller than the phonon wavelength. Specular reflection does not randomize the phonon distribution, allowing phonons to maintain directional transport.</p>

<p>Diffuse reflection occurs when the boundary roughness is comparable to or larger than the phonon wavelength. Diffuse reflection leads to an isotropic phonon distribution, reducing the efficiency of phonon heat transfer. In nanostructures, diffuse reflection enhances phonon-boundary scattering effects, significantly reducing the material’s effective thermal conductivity.</p>

<h3 id="32-isothermal-boundary">3.2 Isothermal Boundary</h3>

<p>Under isothermal boundary conditions at temperature $T_b$, phonons incident on the boundary are completely absorbed. The boundary then re-emits phonons according to its own temperature $T_b$, following the equilibrium distribution.</p>

<p>The emitted heat flux per unit angular frequency can be expressed as:</p>

\[q_{\omega,b}'' = \frac{1}{4} \sum_p \frac{D(\omega,p)v_g(\omega,p)\hbar\omega}{\exp\left(\frac{\hbar\omega}{k_B T_b}\right) - 1}\]

<p>In deviational energy-based simulations, the difference in heat flux between the isothermal boundary and the reference equilibrium temperature $T_\text{eq}$ must be considered. The corrected expression is given by:</p>

\[q_{\omega,b}'' = \frac{1}{4} \sum_p D(\omega,p)v_g(\omega,p)\hbar\omega \cdot \bigg[\frac{1}{\exp\left(\frac{\hbar\omega}{k_B T_b}\right) - 1} - \frac{1}{\exp\left(\frac{\hbar\omega}{k_B T_\text{eq}}\right) - 1} \bigg]\]

<p>This formula provides the frequency distribution of emitted particles under isothermal boundary conditions. Specifically, it reflects the non-equilibrium phonon transport characteristics of the boundary at temperature $T_b$, i.e., how the boundary absorbs and re-emits phonons based on the temperature difference.</p>

<h3 id="33-periodic-boundary">3.3 Periodic Boundary</h3>

<p>Periodic boundary conditions allow the simulation of a complete structure by considering only a single unit cell (period).</p>

<div class="row">
    <div class="col-md-10 text-center">
        



<figure>
  <picture>
    <!-- Auto scaling with imagemagick -->
    <!--
      See https://www.debugbear.com/blog/responsive-images#w-descriptors-and-the-sizes-attribute and
      https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images for info on defining 'sizes' for responsive images
    -->
    
      <source class="responsive-img-srcset" srcset="/assets/img/blog/peri_bond-480.webp 480w,/assets/img/blog/peri_bond-800.webp 800w,/assets/img/blog/peri_bond-1400.webp 1400w," type="image/webp" sizes="95vw"></source>
    
    <img src="/assets/img/blog/peri_bond.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>

  
</figure>

    </div>
</div>

<p>At the boundary, deviations in phonon distribution from local equilibrium are periodic and can be described by the following relations:</p>

\[f_1^+ - f_{T_1}^\text{eq} = f_2^+ - f_{T_2}^\text{eq}\]

\[f_1^- - f_{T_1}^\text{eq} = f_2^- - f_{T_2}^\text{eq}\]

<p>Here, $f_{T_1}^\text{eq}$ and $f_{T_2}^\text{eq}$ denote the equilibrium distributions at temperatures $T_1$ and $T_2$, respectively. The superscript $+$ represents particles moving to the right, while $-$ represents particles moving to the left. This formula reflects both the periodicity of heat flux and the temperature gradient.</p>

<p>For deviational energy distribution, this relationship becomes:</p>

\[\hbar\omega(f_1^+ - f_{T_\text{eq}}^\text{eq} - f_{T_1}^\text{eq}) = \hbar\omega(f_2^+ - f_{T_\text{eq}}^\text{eq} - f_{T_2}^\text{eq})\]

\[\hbar\omega(f_1^- - f_{T_\text{eq}}^\text{eq} - f_{T_1}^\text{eq}) = \hbar\omega(f_2^- - f_{T_\text{eq}}^\text{eq} - f_{T_2}^\text{eq})\]

<p>Expressed in terms of deviational energy:</p>

\[e_1^{d,+} - e_{T_1}^\text{eq} = e_2^{d,+} - e_{T_2}^\text{eq}\]

\[e_1^{d,-} - e_{T_1}^\text{eq} = e_2^{d,-} - e_{T_2}^\text{eq}\]

<p>Periodic boundary conditions can be enforced as follows:</p>

<p>(i) Remove particles crossing the periodic boundary from one side of the system and reinsert them on the other side, keeping their properties unchanged.</p>

<p>(ii) Generate new particles at the boundary: these particles have directions randomized over a hemisphere. At the hot boundary, they are emitted to the right with a positive sign, while corresponding negative particles are emitted from the cold boundary. Particle generation follows the distribution:</p>

\[(e_{T_1}^\text{eq}-e_{T_2}^\text{eq})\frac{D(\omega,p)}{4\pi} v_g(\omega,p)\]

<hr>

<h2 id="references">References:</h2>

<p>[1] S. Mazumder, A. Majumdar, Monte Carlo Study of Phonon Transport in Solid Thin Films Including Dispersion and Polarization, Journal of Heat Transfer 123 (2001) 749–759.</p>

<p>[2] Q. Hao, G. Chen, M.-S. Jeng, Frequency-dependent Monte Carlo simulations of phonon transport in two-dimensional porous silicon with aligned pores, Journal of Applied Physics 106 (2009) 114321.</p>

<p>[3] J.-P.M. Péraud, N.G. Hadjiconstantinou, Efficient simulation of multidimensional phonon transport using energy-based variance-reduced Monte Carlo formulations, Phys. Rev. B 84 (2011) 205331.</p>

      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

      <d-bibliography src="/assets/bibliography/"></d-bibliography>

      
      
    </div>

    <!-- Footer -->
    
  <footer class="fixed-bottom" role="contentinfo">
    <div class="container mt-0">
      © Copyright 2025
      Shixian
      
      Liu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> . Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      
      
    </div>
  </footer>


    <!-- Bootsrap & MDB scripts -->
<script src="/assets/js/bootstrap.bundle.min.js"></script>
<!-- <script src="/assets/js/mdb.min.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    




    
  <!-- Scrolling Progress Bar -->
  <script type="text/javascript">
    /*
     * This JavaScript code has been adapted from the article
     * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar,
     * published on the website https://css-tricks.com on the 7th of May, 2014.
     * Couple of changes were made to the original code to make it compatible
     * with the `al-foio` theme.
     */
    const progressBar = $('#progress');
    /*
     * We set up the bar after all elements are done loading.
     * In some cases, if the images in the page are larger than the intended
     * size they'll have on the page, they'll be resized via CSS to accomodate
     * the desired size. This mistake, however, breaks the computations as the
     * scroll size is computed as soon as the elements finish loading.
     * To account for this, a minimal delay was introduced before computing the
     * values.
     */
    window.onload = function () {
      setTimeout(progressBarSetup, 50);
    };
    /*
     * We set up the bar according to the browser.
     * If the browser supports the progress element we use that.
     * Otherwise, we resize the bar thru CSS styling
     */
    function progressBarSetup() {
      if ('max' in document.createElement('progress')) {
        initializeProgressElement();
        $(document).on('scroll', function () {
          progressBar.attr({ value: getCurrentScrollPosition() });
        });
        $(window).on('resize', initializeProgressElement);
      } else {
        resizeProgressBar();
        $(document).on('scroll', resizeProgressBar);
        $(window).on('resize', resizeProgressBar);
      }
    }
    /*
     * The vertical scroll position is the same as the number of pixels that
     * are hidden from view above the scrollable area. Thus, a value > 0 is
     * how much the user has scrolled from the top
     */
    function getCurrentScrollPosition() {
      return $(window).scrollTop();
    }

    function initializeProgressElement() {
      let navbarHeight = $('#navbar').outerHeight(true);
      $('body').css({ 'padding-top': navbarHeight });
      $('progress-container').css({ 'padding-top': navbarHeight });
      progressBar.css({ top: navbarHeight });
      progressBar.attr({
        max: getDistanceToScroll(),
        value: getCurrentScrollPosition(),
      });
    }
    /*
     * The offset between the html document height and the browser viewport
     * height will be greater than zero if vertical scroll is possible.
     * This is the distance the user can scroll
     */
    function getDistanceToScroll() {
      return $(document).height() - $(window).height();
    }

    function resizeProgressBar() {
      progressBar.css({ width: getWidthPercentage() + '%' });
    }
    // The scroll ratio equals the percentage to resize the bar
    function getWidthPercentage() {
      return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
    }
  </script>


    
  <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script>
  <script>
    addBackToTop();
  </script>


    
  <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script>
  <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching">
    
    <div class="modal-footer" slot="footer">
      <span class="help">
        <svg version="1.0" class="ninja-examplekey" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1280 1280">
          <path d="M1013 376c0 73.4-.4 113.3-1.1 120.2a159.9 159.9 0 0 1-90.2 127.3c-20 9.6-36.7 14-59.2 15.5-7.1.5-121.9.9-255 1h-242l95.5-95.5 95.5-95.5-38.3-38.2-38.2-38.3-160 160c-88 88-160 160.4-160 161 0 .6 72 73 160 161l160 160 38.2-38.3 38.3-38.2-95.5-95.5-95.5-95.5h251.1c252.9 0 259.8-.1 281.4-3.6 72.1-11.8 136.9-54.1 178.5-116.4 8.6-12.9 22.6-40.5 28-55.4 4.4-12 10.7-36.1 13.1-50.6 1.6-9.6 1.8-21 2.1-132.8l.4-122.2H1013v110z"></path>
        </svg>
        to select
      </span>
      <span class="help">
        <svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey" viewbox="0 0 24 24">
          <path d="M0 0h24v24H0V0z" fill="none"></path>
          <path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"></path>
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey" viewbox="0 0 24 24">
          <path d="M0 0h24v24H0V0z" fill="none"></path>
          <path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path>
        </svg>
        to navigate
      </span>
      <span class="help">
        <span class="ninja-examplekey esc">esc</span>
        to close
      </span>
      <span class="help">
        <svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey backspace" viewbox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M6.707 4.879A3 3 0 018.828 4H15a3 3 0 013 3v6a3 3 0 01-3 3H8.828a3 3 0 01-2.12-.879l-4.415-4.414a1 1 0 010-1.414l4.414-4.414zm4 2.414a1 1 0 00-1.414 1.414L10.586 10l-1.293 1.293a1 1 0 101.414 1.414L12 11.414l1.293 1.293a1 1 0 001.414-1.414L13.414 10l1.293-1.293a1 1 0 00-1.414-1.414L12 8.586l-1.293-1.293z" clip-rule="evenodd"></path>
        </svg>
        move to parent
      </span>
    </div>
  </ninja-keys>
  <script>
    let searchTheme = determineComputedTheme();
    const ninjaKeys = document.querySelector('ninja-keys');

    if (searchTheme === 'dark') {
      ninjaKeys.classList.add('dark');
    } else {
      ninjaKeys.classList.remove('dark');
    }

    const openSearchModal = () => {
      // collapse navbarNav if expanded on mobile
      const $navbarNav = $('#navbarNav');
      if ($navbarNav.hasClass('show')) {
        $navbarNav.collapse('hide');
      }
      ninjaKeys.open();
    };
  </script>
  
  <script>
    // get the ninja-keys element
    const ninja = document.querySelector('ninja-keys');

    // add the home and posts menu items
    ninja.data = [{
        id: "nav-home",
        title: "Home",
        section: "Navigation menu",
        handler: () => {
          window.location.href = "/";
        },
      },{id: "nav-blog",
              title: "Blog",
              description: "",
              section: "Navigation menu",
              handler: () => {
                window.location.href = "/blog/";
              },
            },{id: "nav-publications",
              title: "Publications",
              description: "Publications indexed in Scopus and Web of Science",
              section: "Navigation menu",
              handler: () => {
                window.location.href = "/publications/";
              },
            },{id: "nav-teaching",
              title: "Teaching",
              description: "Lectures",
              section: "Navigation menu",
              handler: () => {
                window.location.href = "/teaching/";
              },
            },{id: "post-topological-quantities-and-properties-of-phonons",
          
            title: "Topological Quantities and Properties of Phonons",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2024/topology/";
            
          },
        },{id: "post-vasp-structure-optimization",
          
            title: "VASP Structure Optimization",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2024/vasp-relax/";
            
          },
        },{id: "post-theoretical-framework-for-phonon-monte-carlo-simulations",
          
            title: "Theoretical framework for phonon Monte Carlo simulations",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2024/MC-phononBTE/";
            
          },
        },{id: "post-numerical-methods-for-density-of-states-dos-calculation",
          
            title: "Numerical Methods for Density of States (DOS) Calculation",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2024/dos-method/";
            
          },
        },{id: "post-phonon-dispersion-calculation-of-silicon-using-qe",
          
            title: "Phonon Dispersion Calculation of Silicon Using QE",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2024/qe-disp-si/";
            
          },
        },{id: "post-self-consistent-energy-calculations-with-qe",
          
            title: "Self-Consistent Energy Calculations with QE",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2024/qe-scf/";
            
          },
        },{id: "post-microscopic-description-of-thermophysics",
          
            title: "Microscopic Description of Thermophysics",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2023/nano-micro-thermophysics/";
            
          },
        },{id: "post-dispersion-relations-of-elastic-waves-in-rods",
          
            title: "Dispersion Relations of Elastic Waves in Rods",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2023/elastic-wave-in-wire/";
            
          },
        },{id: "post-dispersion-relations-of-elastic-waves-in-plates",
          
            title: "Dispersion Relations of Elastic Waves in Plates",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2023/elastic-wave-in-plate/";
            
          },
        },{id: "post-classical-kinetic-theory-of-heat-conduction",
          
            title: "Classical Kinetic Theory of Heat Conduction",
          
          description: "",
          section: "Posts",
          handler: () => {
            
              window.location.href = "/blog/2023/classical-kinetic-theory/";
            
          },
        },{id: "news-graduated-from-bauman-moscow-state-technical-university-with-a-master-39-s-degree-in-nuclear-energy-and-thermophysics-and-received-a-badge-with-honors-media-https-bmstu-ru-news-kto-inzhener-ya-inzhener-v-baumanke-proshlo-posvyashenie-v-inzhenery",
              title: 'Graduated from Bauman Moscow State Technical University with a Master&amp;#39;s degree in Nuclear...',
              description: "",
              section: "News",},{id: "news-started-my-phd-research-on-the-topic-quot-determination-of-the-thermophysical-properties-of-nanostructures-taking-into-account-the-quantum-mechanical-properties-of-phonons-and-electrons-quot",
              title: 'Started my PhD research on the topic &amp;quot;Determination of the thermophysical properties of...',
              description: "",
              section: "News",},{id: "news-invited-to-participate-in-the-russian-universities-alumni-meeting-on-quot-green-technology-for-the-younger-generation-quot-at-the-international-forum-atomexpo-2024-media-https-www-rudn-ru-media-news-international-cooperation-rudn-provel-vstrechu-vypusknikov-partnerskih-vuzov-gk-rosatom-na-mejdunarodnom-forume-atomekspo-2024",
              title: 'Invited to participate in the Russian universities alumni meeting on &amp;quot;Green technology for...',
              description: "",
              section: "News",},{
            id: 'social-email',
            title: 'Send an email',
            section: 'Socials',
            handler: () => {
              window.open("mailto:%73%78%6C%69%75%39%38@%67%6D%61%69%6C.%63%6F%6D", "_blank");
            },
          },{
            id: 'social-github',
            title: 'GitHub',
            section: 'Socials',
            handler: () => {
              window.open("https://github.com/lyushisyan# your GitHub user name", "_blank");
            },
          },{
            id: 'social-orcid',
            title: 'ORCID',
            section: 'Socials',
            handler: () => {
              window.open("https://orcid.org/0000-0003-3042-7817", "_blank");
            },
          },{
            id: 'social-scholar',
            title: 'Google Scholar',
            section: 'Socials',
            handler: () => {
              window.open("https://scholar.google.com/citations?user=bLVSRuUAAAAJ", "_blank");
            },
          },{
              id: 'lang-zh-CN',
              title: 'zh-CN',
              section: 'Languages',
              handler: () => {
                window.location.href = "/zh-CN/blog/2024/MC-phononBTE/";
              },
            },{
          id: 'light-theme',
          title: 'Change theme to light',
          description: 'Change the theme of the site to Light',
          section: 'Theme',
          handler: () => {
            setThemeSetting("light");
          },
        },
        {
          id: 'dark-theme',
          title: 'Change theme to dark',
          description: 'Change the theme of the site to Dark',
          section: 'Theme',
          handler: () => {
            setThemeSetting("dark");
          },
        },
        {
          id: 'system-theme',
          title: 'Use system default theme',
          description: 'Change the theme of the site to System Default',
          section: 'Theme',
          handler: () => {
            setThemeSetting("system");
          },
        },];
  </script>
  <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script>


  
</body>
</html>
