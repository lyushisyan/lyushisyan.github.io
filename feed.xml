<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://lyushisyan.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://lyushisyan.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2026-01-24T22:12:20+00:00</updated><id>https://lyushisyan.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Callaway Two-Relaxation-Time Model</title><link href="https://lyushisyan.github.io/blog/2025/callaway/" rel="alternate" type="text/html" title="Callaway Two-Relaxation-Time Model"/><published>2025-11-16T22:36:10+00:00</published><updated>2025-11-16T22:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2025/callaway</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2025/callaway/"><![CDATA[<p>It is well known that normal processes (i.e., scattering processes that conserve the total crystal momentum) cannot by themselves produce a finite thermal conductivity. Therefore, one cannot simply add the inverse relaxation time of normal processes (N processes) to those of momentum-destroying processes. Examples of the latter include Umklapp processes, impurity scattering, and boundary scattering. Throughout this article, all such momentum-nonconserving processes will be collectively referred to as <strong>R processes</strong>.</p> <h2 id="1-phonons-distributions-and-scattering-classification">1. Phonons, distributions, and scattering classification</h2> <p>For a phonon mode $\lambda \equiv (\mathbf{q}, j)$, we have</p> <ul> <li>frequency: $\omega_\lambda$</li> <li>group velocity: $\mathbf{v}_\lambda$</li> <li>wave vector: $\mathbf{k}_\lambda$</li> </ul> <p>The equilibrium Bose–Einstein distribution is</p> \[n_{\lambda}^{(0)}(T) = \frac{1}{\exp(\hbar\omega_\lambda/k_B T) - 1}.\] <p>In the presence of a temperature gradient $\nabla T$, the occupation becomes</p> \[n_\lambda = n_{\lambda}^{(0)} + n_{1,\lambda}, \qquad |n_{1,\lambda}|\ll n_{\lambda}^{(0)}.\] <p>Scattering is classified into two categories — the core of the Callaway model:</p> <ul> <li><strong>N processes (normal)</strong>: conserve total momentum; relaxation time $\tau_{N,\lambda}$</li> <li><strong>R processes (resistive)</strong>: destroy total momentum (Umklapp, impurity, boundary, etc.); relaxation time $\tau_{R,\lambda}$</li> </ul> <blockquote> <p>Key point: <strong>N processes do not generate thermal resistance</strong>.<br/> They merely establish a “drifting” equilibrium state of the phonon gas, while the actual dissipation of heat flux is governed by R processes.</p> </blockquote> <h2 id="2-bte-and-the-callaway-model">2. BTE and the Callaway model</h2> <p>In steady state, driven only by a temperature gradient, the linearized BTE can be written as</p> \[\mathbf{v}_\lambda \cdot \nabla T \,\frac{\partial n_{\lambda}^{(0)}}{\partial T} = \left(\frac{\partial n_\lambda}{\partial t}\right)_{\text{coll}}. \tag{1}\] <p>Callaway splits the collision term into two parts:</p> \[\left(\frac{\partial n_\lambda}{\partial t}\right)_{\text{coll}} = -\frac{n_\lambda - n_{\lambda}^{(d)}}{\tau_{N,\lambda}} -\frac{n_\lambda - n_{\lambda}^{(0)}}{\tau_{R,\lambda}}. \tag{2}\] <ul> <li>The first term: N processes drive the system toward a <strong>displaced equilibrium state</strong> $n_{\lambda}^{(d)}$</li> <li>The second term: R processes push the system back to the <strong>ordinary equilibrium</strong> $n_{\lambda}^{(0)}$</li> </ul> <p>The “displaced Planck distribution” is</p> \[n_{\lambda}^{(d)} = \left[ \exp\left( \frac{\hbar\omega_\lambda - \boldsymbol{\Lambda}\cdot\mathbf{k}_\lambda}{k_B T} \right) -1 \right]^{-1}, \tag{3}\] <p>where $\boldsymbol{\Lambda}$ is a small vector describing the collective drift of the phonon system, aligned with $\nabla T$.</p> <h2 id="3-first-order-expansion-of-the-displaced-distribution-from-energy-derivative-to-temperature-derivative">3. First-order expansion of the displaced distribution: from energy derivative to temperature derivative</h2> <p>Introduce the dimensionless variable</p> \[x_\lambda = \frac{\hbar\omega_\lambda}{k_B T}.\] <p>Expanding Eq. (3) to first order in $\boldsymbol{\Lambda}\cdot\mathbf{k}_\lambda$, we obtain</p> \[n_{\lambda}^{(d)} \simeq n_{\lambda}^{(0)} + \frac{\partial n_{\lambda}^{(0)}}{\partial(\hbar\omega_\lambda)}\, (\boldsymbol{\Lambda}\cdot\mathbf{k}_\lambda). \tag{4}\] <p>Convert the derivative with respect to energy into a temperature derivative:</p> \[n_{\lambda}^{(d)} \simeq n_{\lambda}^{(0)} - \frac{\partial n_{\lambda}^{(0)}}{\partial T}\, \frac{\boldsymbol{\Lambda}\cdot\mathbf{k}_\lambda}{k_B T}. \tag{5}\] <h2 id="4-linearized-bte">4. Linearized BTE</h2> <p>Insert</p> \[n_\lambda = n_{\lambda}^{(0)} + n_{1,\lambda}\] <p>and Eq. (5) into Eqs. (1) and (2), keeping only first-order terms.<br/> Left-hand side:</p> \[\mathbf{v}_\lambda \cdot \nabla T \,\frac{\partial n_{\lambda}^{(0)}}{\partial T}.\] <p>Right-hand side:</p> \[-\frac{n_\lambda - n_{\lambda}^{(d)}}{\tau_{N,\lambda}} -\frac{n_\lambda - n_{\lambda}^{(0)}}{\tau_{R,\lambda}} = -\left(\frac{1}{\tau_{N,\lambda}}+\frac{1}{\tau_{R,\lambda}}\right)n_{1,\lambda} + \frac{n_{\lambda}^{(d)}-n_{\lambda}^{(0)}}{\tau_{N,\lambda}}.\] <p>Thus,</p> \[\mathbf{v}_\lambda \cdot \nabla T \,\frac{\partial n_{\lambda}^{(0)}}{\partial T} = -\left(\frac{1}{\tau_{N,\lambda}}+\frac{1}{\tau_{R,\lambda}}\right)n_{1,\lambda} + \frac{n_{\lambda}^{(d)}-n_{\lambda}^{(0)}}{\tau_{N,\lambda}}. \tag{6}\] <p>Define the combined relaxation time (“N+R combined”)</p> \[\frac{1}{\tau_{c,\lambda}} = \frac{1}{\tau_{N,\lambda}}+\frac{1}{\tau_{R,\lambda}}. \tag{7}\] <p>Solve for $n_{1,\lambda}$:</p> \[n_{1,\lambda} = \tau_{c,\lambda}\,\mathbf{v}_\lambda\cdot\nabla T\, \frac{\partial n_{\lambda}^{(0)}}{\partial T} + \frac{\tau_{c,\lambda}}{\tau_{N,\lambda}}\left(n_{\lambda}^{(d)}-n_{\lambda}^{(0)}\right). \tag{8}\] <p>Insert Eq. (5):</p> \[n_{1,\lambda} = \tau_{c,\lambda}\,\frac{\partial n_{\lambda}^{(0)}}{\partial T} \left[ \mathbf{v}_\lambda\cdot\nabla T - \frac{\boldsymbol{\Lambda}\cdot\mathbf{k}_\lambda}{k_B T} \frac{1}{\tau_{N,\lambda}} \right]. \tag{9}\] <blockquote> <p>Interpretation:</p> <ul> <li>First term: <strong>RTA-like</strong>, except the relaxation time becomes $\tau_c$.</li> <li>Second term: the correction involving “$\boldsymbol{\Lambda}$”, originating entirely from <strong>momentum conservation of N processes</strong>.</li> </ul> </blockquote> <h2 id="5-determining-the-drift-parameter-from-momentum-conservation-of-n-processes">5. Determining the drift parameter from momentum conservation of N processes</h2> <p>Physical condition: <strong>normal processes do not change the total crystal momentum</strong>, hence</p> \[\sum_\lambda \hbar \mathbf{k}_\lambda \left(\frac{\partial n_\lambda}{\partial t}\right)_{N} = -\sum_\lambda \hbar \mathbf{k}_\lambda \frac{n_\lambda - n_{\lambda}^{(d)}}{\tau_{N,\lambda}} =0. \tag{10}\] <p>When the temperature gradient is one-dimensional, $\boldsymbol{\Lambda}$ is parallel to $\nabla T$, so we write</p> \[\boldsymbol{\Lambda} = -\beta\,\nabla T, \tag{11}\] <p>where $\beta$ is an “effective time–like parameter”.</p> <p>Substituting Eqs. (9) and (11) into Eq. (10), and using</p> \[C_\lambda = \hbar\omega_\lambda\,\frac{\partial n_{\lambda}^{(0)}}{\partial T}\] <p>(the modal heat capacity), one can obtain $\beta$ in the discrete-sum form</p> \[\beta = \frac{ \displaystyle\sum_\lambda C_\lambda v_{\lambda x}^2\,\tau_{c,\lambda}^2/\tau_{N,\lambda} }{ \displaystyle\sum_\lambda C_\lambda v_{\lambda x}^2 \left(1-\tau_{c,\lambda}/\tau_{N,\lambda}\right) }. \tag{12}\] <blockquote> <p>This is the “locking mechanism” of the Callaway model, linking the drift strength $\beta$ to the modal relaxation times $\tau_N$ and $\tau_R$.</p> </blockquote> <h2 id="6-total-thermal-conductivity">6. Total thermal conductivity</h2> <p>The heat flux along the $x$ direction is</p> \[J_x = \frac{1}{V}\sum_\lambda \hbar\omega_\lambda v_{\lambda x}\,n_{1,\lambda}.\] <p>Together with Fourier’s law,</p> \[J_x = -\kappa\,\frac{\partial T}{\partial x},\] <p>Eqs. (9) and (11) lead to the decomposition</p> \[\kappa = \kappa_1 + \kappa_2.\] <h3 id="61-first-term-rta-with-the-combined-relaxation-time-tau_c">6.1 First term: RTA with the combined relaxation time $\tau_c$</h3> <p>This term resembles the conventional RTA expression, except that $\tau$ is replaced with $\tau_c$:</p> \[\kappa_1 = \frac{1}{V} \sum_\lambda C_\lambda v_{\lambda x}^2 \tau_{c,\lambda}. \tag{13}\] <p>In the absence of N processes ($\tau_{N,\lambda}\to\infty$),<br/> $\tau_{c,\lambda} \to \tau_{R,\lambda}$, and Eq. (13) reduces to the familiar RTA formula.</p> <h3 id="62-second-term-callaway-correction-kappa_2">6.2 Second term: Callaway correction $\kappa_2$</h3> <p>The contribution induced by normal processes is</p> \[\kappa_2 = \frac{1}{V} \frac{ \left[ \displaystyle\sum_\lambda C_\lambda v_{\lambda x}^2\,\tau_{c,\lambda}^2/\tau_{N,\lambda} \right]^2 }{ \displaystyle\sum_\lambda C_\lambda v_{\lambda x}^2 \left(1-\tau_{c,\lambda}/\tau_{N,\lambda}\right) }. \tag{14}\] <blockquote> <p>Intuitive picture:</p> <ul> <li>Numerator: roughly the squared sum of all <strong>drift-type contributions</strong> enabled by N processes.</li> <li>Denominator: the total strength of R processes that pull the distribution back from this drift.</li> <li>When R is strong and N weak, the correction collapses, $\kappa_2\to 0$.</li> <li>When N dominates and R is weak, $\kappa_2$ increases significantly, enhancing the total conductivity — reminiscent of <strong>phonon hydrodynamic behavior</strong>.</li> </ul> </blockquote> <h2 id="7-summary">7. Summary</h2> <ul> <li> <p><strong>Starting point (BTE)</strong>:<br/> A temperature gradient drives phonon occupations out of equilibrium; the collision term pulls the system toward some “equilibrium-like” state.</p> </li> <li><strong>Callaway’s key idea</strong>:<br/> Split the notion of equilibrium into two levels: <ul> <li>N processes → create a drifted equilibrium $n_{\lambda}^{(d)}$;</li> <li>R processes → provide actual dissipation, restoring the true equilibrium $n_{\lambda}^{(0)}$.</li> </ul> </li> <li><strong>Mathematically</strong>: <ul> <li>Define the displaced distribution and perform a first-order expansion;</li> <li>Introduce the combined relaxation time $\tau_c^{-1} = \tau_N^{-1} + \tau_R^{-1}$;</li> <li>Use the momentum-conservation condition for N processes to determine the drift strength $\beta$;</li> <li>Obtain $\kappa = \kappa_1 + \kappa_2$, where <ul> <li>$\kappa_1$: RTA-like term using $\tau_c$;</li> <li>$\kappa_2$: additional contribution from N processes.</li> </ul> </li> </ul> </li> <li><strong>Limiting cases</strong>: <ul> <li>Weak N processes: $\tau_{N,\lambda} \to \infty$, $\kappa_2 \to 0$ → reduces to ordinary RTA;</li> <li>Strong N and weak R processes: $\kappa_2$ becomes large → high thermal conductivity characteristic of <strong>hydrodynamic phonon transport</strong>.</li> </ul> </li> </ul> <hr/> <p>References:</p> <p>[1] Phys. Rev. <em>113</em>, 1046–1051 (1959).</p> <p>[2] Phys. Rev. B <em>88</em>, 144302 (2013).</p> <p>[3] Phys. Rev. B <em>90</em>, 035203 (2014).</p>]]></content><author><name></name></author><category term="physics"/><category term="phonon"/><category term="heat-conduction"/><category term="bte"/><category term="callaway-model"/><category term="physics"/><summary type="html"><![CDATA[A theoretical derivation of the Callaway model, separating Normal and Resistive scattering processes to calculate thermal conductivity.]]></summary></entry><entry><title type="html">A Unified Theoretical Framework for Phonon Heat Conduction (WTE)</title><link href="https://lyushisyan.github.io/blog/2025/wigner/" rel="alternate" type="text/html" title="A Unified Theoretical Framework for Phonon Heat Conduction (WTE)"/><published>2025-10-05T23:36:10+00:00</published><updated>2025-10-05T23:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2025/wigner</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2025/wigner/"><![CDATA[<p>In solids, the main carriers of heat are phonons. For decades, researchers have proposed two classic theories to explain phonon heat transport in different kinds of materials:</p> <ul> <li><strong>In crystals</strong>, phonons behave like little particles that fly and scatter, and heat conduction is described by the <strong>Peierls–Boltzmann Equation (BTE)</strong>.</li> <li><strong>In glasses</strong>, phonons lose their “particle-like” character, vibrational modes become localized, and heat flow proceeds via <strong>coherent tunneling diffusion between different modes</strong>. This is the physical picture behind the <strong>Allen–Feldman (AF) equation</strong>.</li> </ul> <p>However, in realistic complex materials, <strong>particle-like and wave-like mechanisms often coexist</strong>. Traditional BTE and AF models each apply only to one extreme limit and lack a unified description.<br/> The <strong>Wigner Transport Equation (WTE)</strong> was introduced precisely to place both limits into a single quantum phase–space framework, thereby providing a unified description.</p> <h2 id="peierlsboltzmann-equation">Peierls–Boltzmann Equation</h2> <blockquote> <p>BTE: Phonons propagate like little particles</p> </blockquote> <p>Applicable systems: long-range ordered crystals with well-separated phonon bands and clearly defined modes.</p> <p>Phonons can be viewed as localized wave packets, like little particles flying through space with a well-defined group velocity, undergoing scattering during their propagation.</p> <p>Linearized BTE:</p> \[\partial_t f_{\mathbf q s} + \mathbf v_{\mathbf q s}\cdot\nabla_{\mathbf r} f_{\mathbf q s} = -\frac{f_{\mathbf q s} - f^{\text{eq}}_{\mathbf q s}}{\tau_{\mathbf q s}}\] <ul> <li>$f_{\mathbf q s}$: phonon occupation function</li> <li>$\mathbf v_{\mathbf q s} = \nabla_{\mathbf q}\omega_{\mathbf q s}$: group velocity</li> <li>$\tau_{\mathbf q s}$: relaxation time</li> </ul> <p><strong>Thermal conductivity in RTA form</strong>:</p> \[\kappa_{\alpha\beta}^{\mathrm{BTE}} = \frac{1}{V}\sum_{\mathbf q s} C_{\mathbf q s}\, v_{\mathbf q s,\alpha}\, v_{\mathbf q s,\beta}\, \tau_{\mathbf q s},\] <h2 id="allenfeldman-equation">Allen–Feldman Equation</h2> <blockquote> <p>AF: Energy is no longer carried by “flying particles”, but transferred by one “tuning fork” driving another into resonance.</p> </blockquote> <p>Applicable systems: glasses and disordered solids.</p> <p>In glasses, vibrational modes are highly localized and possess almost no effective group velocity. Energy is not transported via “phonon particles” but instead diffuses through <strong>tunneling/resonant coupling between different localized states</strong>:</p> <ul> <li>Energy spacing between vibrational states is extremely small (quasi-degenerate), allowing mutual coupling.</li> <li>This can be likened to “a row of tuning forks”: when frequencies are close, striking one tuning fork can drive the neighboring ones, and energy is passed along step by step.</li> </ul> <p><strong>Mathematical expression</strong>:</p> \[\kappa_{\text{AF}} = \frac{\pi}{V} \sum_{i\neq j} (n_i - n_j)\, |\langle i | \hat v | j \rangle|^2 \, \delta(\omega_i - \omega_j)\] <ul> <li>$\hat v$: heat current (velocity) operator</li> <li>$\delta(\omega_i - \omega_j)$: energy conservation; only quasi-degenerate states can couple to each other</li> </ul> <h2 id="wigner-transport-equation">Wigner Transport Equation</h2> <blockquote> <p>WTE: The “director” that puts both “particles” and “tuning forks” on the same stage</p> </blockquote> <p>Starting from the quantum mechanical <strong>one-body density matrix</strong> and performing a <strong>Wigner transformation</strong>, one obtains a distribution function in phase space (momentum $\mathbf q$ and real space $\mathbf R$):</p> \[n_{s,s'}(\mathbf q, \mathbf R, t)\] <p><strong>Diagonal elements ($s=s’$)</strong>: populations, corresponding to particle-like mechanisms, similar to BTE.<br/> <strong>Off-diagonal elements ($s\neq s’$)</strong>: coherences, corresponding to wave-like mechanisms, similar to AF.</p> <p><strong>The unique feature of WTE is that it tracks not only the number of phonons, but also the coherence between different phonon states.</strong></p> <p>The general form of WTE is:</p> \[\frac{\partial}{\partial t} n_{s,s'} + i(\omega_{\mathbf q s}-\omega_{\mathbf q s'})\,n_{s,s'} + \tfrac{1}{2}\{\mathbf v(\mathbf q), \nabla_{\mathbf R} n\}_{s,s'} = \left.\frac{\partial n}{\partial t}\right|_{\text{scatt}}\] <p>where</p> <ul> <li>First term: time evolution (dynamical change)</li> <li>Second term: coherent oscillation (wave-like mechanism)</li> <li>Third term: drift term (particle transport)</li> <li>Right-hand side: scattering term (anharmonic effects)</li> </ul> <p>In the <strong>crystalline limit</strong>: band separations are large ($\Delta \omega \gg 1/\tau$), coherence terms oscillate rapidly and average out, and WTE → BTE.</p> <p>In the <strong>glassy limit</strong>: modes are quasi-degenerate ($\Delta \omega \ll 1/\tau$), the particle term becomes ineffective, and WTE → AF.</p> <p>In <strong>complex crystals / intermediate regimes</strong>: $\Delta \omega \sim 1/\tau$, particle and wave contributions are inseparable, and WTE yields</p> \[\kappa = \kappa_P + \kappa_C\] <ul> <li> <p><strong>Particle term (populations)</strong>: under weak interband-coupling approximation, it can be written in a form similar to BTE:</p> \[\kappa_{\alpha\beta}^{P} \simeq \frac{1}{V}\sum_{\mathbf q s} C_{\mathbf q s}\, v_{\mathbf q s,\alpha}\, v_{\mathbf q s,\beta}\, \tilde{\tau}_{\mathbf q s},\] <p>where $\tilde{\tau}<em>{\mathbf q s}\approx \big(2\Gamma</em>{\mathbf q s}\big)^{-1}$ is related to the spectral linewidth $\Gamma_{\mathbf q s}$ (arising from anharmonicity, isotope scattering, etc.), reflecting a spectroscopic correction to the “particle lifetime” in WTE.</p> </li> <li> <p><strong>Coherent term (coherences)</strong>: characterizes wave-like coupling/tunneling between quasi-degenerate modes. A commonly used Lorentzian-type expression in the frequency domain can be written as</p> \[\kappa_{\alpha\beta}^{C} \simeq \frac{1}{V}\sum_{\mathbf q}\!\!\sum_{s\neq s'} \frac{\big[\hbar(\omega_{\mathbf q s}+\omega_{\mathbf q s'})/2\big]\, \partial_T n^{\mathrm{eq}}_{\bar{\omega}}} {(\omega_{\mathbf q s}-\omega_{\mathbf q s'})^{2} +(\Gamma_{\mathbf q s}+\Gamma_{\mathbf q s'})^{2}}\, (v_{\alpha})_{s s'}(v_{\beta})_{s' s}\, \big(\Gamma_{\mathbf q s}+\Gamma_{\mathbf q s'}\big),\] <p>where $(v_{\alpha})_{ss’}$ denotes the <strong>off-diagonal elements</strong> of the velocity operator in the mode basis (determining the strength of coherent coupling), $\bar{\omega}$ is an appropriate average of the two mode frequencies, and $\Gamma$ controls the width associated with decoherence/dephasing.</p> </li> </ul> <p>This expression highlights that <strong>smaller band separations between modes, larger off-diagonal velocity matrix elements, and moderate linewidths all enhance coherent heat transport</strong>.</p> <h2 id="relations-and-unification-of-the-three-theories">Relations and Unification of the Three Theories</h2> <ul> <li><strong>BTE limit</strong>: When band separations are much larger than linewidths, coherent effects can be neglected and WTE automatically reduces to BTE.</li> <li><strong>AF limit</strong>: In the strongly disordered limit, WTE reduces to the AF equation.</li> <li><strong>Complex crystals and intermediate regimes</strong>: When band spacings are comparable to phonon linewidths, neither BTE nor AF is sufficient. WTE simultaneously captures contributions from populations and coherent states and yields the full thermal conductivity.</li> </ul> <p><strong>Thus, WTE is not only a mathematical unification but also a physical bridge between these pictures.</strong></p> <hr/> <p>References:</p> <p>[1] <em>Nat. Phys.</em> <strong>15</strong>, 809–813 (2019)</p> <p>[2] <em>Phys. Rev. X</em> <strong>12</strong>, 041011 (2022)</p>]]></content><author><name></name></author><category term="physics"/><category term="wte"/><category term="bte"/><category term="phonon"/><category term="thermal-conductivity"/><category term="physics"/><summary type="html"><![CDATA[An overview of the Wigner Transport Equation (WTE) as a unified framework for phonon heat transport, bridging the gap between the particle-like Peierls-Boltzmann (BTE) model for crystals and the wave-like Allen-Feldman (AF) theory for glasses.]]></summary></entry><entry><title type="html">Thermal Conductivity Calculation using VASP + Phono3py</title><link href="https://lyushisyan.github.io/blog/2025/vasp-phono3py/" rel="alternate" type="text/html" title="Thermal Conductivity Calculation using VASP + Phono3py"/><published>2025-05-20T23:36:10+00:00</published><updated>2025-05-20T23:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2025/vasp-phono3py</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2025/vasp-phono3py/"><![CDATA[<p>VASP is a first-principles simulation software. Phono3py can calculate <strong>phonon-phonon interactions</strong> through <strong>third-order force constants</strong>. This allows the computation of lattice thermal conductivity, phonon lifetimes/linewidths, the imaginary part of self-energy (lowest-order approximation), joint density of states (JDOS), and weighted JDOS (w-JDOS).</p> <h2 id="1-generate-displaced-supercells-poscar-files">1. Generate Displaced Supercells (<code class="language-plaintext highlighter-rouge">POSCAR</code> files)</h2> <p>Taking diamond-structured silicon (Si) as an example, the primitive cell <code class="language-plaintext highlighter-rouge">POSCAR-unitcell</code> looks like:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Si
   1.0
     5.4335600309153529    0.0000000000000000    0.0000000000000000
     0.0000000000000000    5.4335600309153529    0.0000000000000000
     0.0000000000000000    0.0000000000000000    5.4335600309153529
 Si
   8
Direct
   0.8750000000000000 0.8750000000000000 0.8750000000000000
   0.8750000000000000 0.3750000000000000 0.3750000000000000
   0.3750000000000000 0.8750000000000000 0.3750000000000000
   0.3750000000000000 0.3750000000000000 0.8750000000000000
   0.1250000000000000 0.1250000000000000 0.1250000000000000
   0.1250000000000000 0.6250000000000000 0.6250000000000000
   0.6250000000000000 0.1250000000000000 0.6250000000000000
   0.6250000000000000 0.6250000000000000 0.1250000000000000
</code></pre></div></div> <p>Based on this unit cell, generate 2×2×2 supercells with displacements for calculating second-order (fc2) and third-order (fc3) force constants:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py -d --dim 2 2 2 -c POSCAR-unitcell
</code></pre></div></div> <p>This generates 111 displaced structures, stored in <code class="language-plaintext highlighter-rouge">phono3py_disp.yaml</code>, and creates 111 <code class="language-plaintext highlighter-rouge">POSCAR-00XXX</code> files (XXX from 000 to 110).</p> <p>To use a larger supercell for fc2 calculation than for fc3:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py -d --dim-fc2 4 4 4 --dim 2 2 2 -c POSCAR-unitcell
</code></pre></div></div> <p>In this case, <code class="language-plaintext highlighter-rouge">POSCAR_FC2-xxxxx</code> files will also be created.</p> <h2 id="2-run-vasp-to-calculate-forces-for-each-supercell">2. Run VASP to Calculate Forces for Each Supercell</h2> <p>To compute the atomic forces in each displaced supercell, use the <code class="language-plaintext highlighter-rouge">POSCAR-xxxxx</code> (and <code class="language-plaintext highlighter-rouge">POSCAR_FC2-xxxxx</code> if applicable) as inputs to VASP. Each displacement supercell also requires <code class="language-plaintext highlighter-rouge">KPOINTS</code>, <code class="language-plaintext highlighter-rouge">POTCAR</code>, and <code class="language-plaintext highlighter-rouge">INCAR</code>.</p> <p>Run each calculation in folders named <code class="language-plaintext highlighter-rouge">disp-xxxxx</code> (and <code class="language-plaintext highlighter-rouge">disp_fc2-xxxxx</code>), where xxxxx is the index. Each folder contains the input files, and the results will be saved in the <code class="language-plaintext highlighter-rouge">vasprun.xml</code> file inside that folder.</p> <p>Use the following script to prepare input folders:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">P</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>

<span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">seq</span> <span class="nt">-f</span> <span class="s2">"%05g"</span> 1 111<span class="si">)</span><span class="p">;</span> <span class="k">do
	</span><span class="nb">dir</span><span class="o">=</span><span class="s2">"disp-</span><span class="nv">$i</span><span class="s2">"</span>
	<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$dir</span><span class="s2">"</span>
	<span class="nb">cd</span> <span class="s2">"</span><span class="nv">$dir</span><span class="s2">"</span> <span class="o">||</span> <span class="k">continue
	</span><span class="nb">cp</span> <span class="s2">"</span><span class="nv">$P</span><span class="s2">"</span>/INCAR <span class="s2">"</span><span class="nv">$P</span><span class="s2">"</span>/KPOINTS <span class="s2">"</span><span class="nv">$P</span><span class="s2">"</span>/POTCAR <span class="nb">.</span>
	<span class="nb">cp</span> <span class="s2">"</span><span class="nv">$P</span><span class="s2">"</span>/POSCAR-<span class="s2">"</span><span class="nv">$i</span><span class="s2">"</span> POSCAR
	<span class="nb">echo</span> <span class="s2">"Prepared </span><span class="nv">$dir</span><span class="s2">"</span>
	<span class="nb">cd</span> <span class="s2">"</span><span class="nv">$P</span><span class="s2">"</span>
<span class="k">done</span>
</code></pre></div></div> <p>Then run the VASP calculations:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">P</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>

<span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">seq</span> <span class="nt">-f</span> <span class="s2">"%05g"</span> 1 111<span class="si">)</span><span class="p">;</span> <span class="k">do
    </span><span class="nv">DIR</span><span class="o">=</span><span class="s2">"</span><span class="nv">$P</span><span class="s2">/disp-</span><span class="nv">$i</span><span class="s2">"</span>
    <span class="nb">cd</span> <span class="s2">"</span><span class="nv">$DIR</span><span class="s2">"</span> <span class="o">||</span> <span class="k">continue
    </span><span class="nb">echo</span> <span class="s2">"Running disp-</span><span class="nv">$i</span><span class="s2">..."</span>

    <span class="c"># Clean old logs</span>
    <span class="nb">rm</span> <span class="nt">-f</span> OUTCAR vasprun.xml log.vasp

    <span class="c"># Run VASP and capture exit code</span>
    mpirun <span class="nt">-np</span> 16 vasp_std <span class="o">&gt;</span> log.vasp 2&gt;&amp;1
    <span class="nv">exit_code</span><span class="o">=</span><span class="nv">$?</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$exit_code</span> <span class="nt">-ne</span> 0 <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"disp-</span><span class="nv">$i</span><span class="s2"> FAILED (exit code </span><span class="nv">$exit_code</span><span class="s2">)"</span>
    <span class="k">elif </span><span class="nb">grep</span> <span class="nt">-q</span> <span class="s2">"F= "</span> log.vasp<span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"disp-</span><span class="nv">$i</span><span class="s2"> completed successfully"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"disp-</span><span class="nv">$i</span><span class="s2"> might be incomplete (check log.vasp)"</span>
    <span class="k">fi

    </span><span class="nb">cd</span> <span class="s2">"</span><span class="nv">$P</span><span class="s2">"</span>
<span class="k">done</span>
</code></pre></div></div> <h2 id="3-collect-force-calculation-results">3. Collect Force Calculation Results</h2> <p>To collect the force sets for fc3 and fc2, use:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py <span class="nt">--cf3</span> disp-<span class="o">{</span>00001..00057<span class="o">}</span>/vasprun.xml
</code></pre></div></div> <p>This generates the <code class="language-plaintext highlighter-rouge">FORCES_FC3</code> file.</p> <p>If larger supercells are used for fc2, collect forces with:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py <span class="nt">--cf2</span> disp_fc2-<span class="o">{</span>00001..00002<span class="o">}</span>/vasprun.xml
</code></pre></div></div> <h2 id="4-create-fc2hdf-and-fc3hdf">4. Create <code class="language-plaintext highlighter-rouge">fc2.hdf</code> and <code class="language-plaintext highlighter-rouge">fc3.hdf</code></h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py --fc-symmetry
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">--fc-symmetry</code> option symmetrizes fc3 and fc2. This command uses <code class="language-plaintext highlighter-rouge">FORCES_FC3</code>, optionally <code class="language-plaintext highlighter-rouge">FORCES_FC2</code>, and <code class="language-plaintext highlighter-rouge">phono3py_disp.yaml</code> to generate <code class="language-plaintext highlighter-rouge">fc2.hdf5</code> and <code class="language-plaintext highlighter-rouge">fc3.hdf5</code>.</p> <p>Although optional, using the <code class="language-plaintext highlighter-rouge">--fc3</code> and <code class="language-plaintext highlighter-rouge">--fc2</code> flags allows loading these files directly without recalculating force constants each time.</p> <h2 id="5-thermal-conductivity-calculation">5. Thermal Conductivity Calculation</h2> <p>A typical command for computing thermal conductivity:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py --mesh 11 11 11 --br
</code></pre></div></div> <p>This may take a long time. The <code class="language-plaintext highlighter-rouge">--thm</code> flag (tetrahedron method) is the default for Brillouin zone integration. You can alternatively use <code class="language-plaintext highlighter-rouge">--sigma</code> to specify a smearing width.</p> <p>The above command computes phonon lifetimes serially over multiple q-points. Since each point is independent, you can parallelize across grid points:</p> <h3 id="step-1-get-irreducible-grid-points">Step 1: Get Irreducible Grid Points</h3> <p>First, generate irreducible q-point info with:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py --fc3 --fc2 --mesh 11 11 11 --br --wgp
</code></pre></div></div> <p>This creates <code class="language-plaintext highlighter-rouge">ir_grid_points.yaml</code>. View the grid point indices with:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grep grid_point: ir_grid_points.yaml | awk '{printf("%d ", $3)}'
</code></pre></div></div> <p>Example output:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 1 2 3 4 5 12 13 14 15 16 17 18 19 20 21 24 25 26 27 28 29 30 31 36 37 38 39 40 41 48 49 50 51 60 61 148 149 150 151 160 161 162 163 164 165 172 173 174 175 184 185 297 298 309 310
</code></pre></div></div> <h3 id="step-2-compute-phonon-lifetimes-for-subset-of-grid-points">Step 2: Compute Phonon Lifetimes for Subset of Grid Points</h3> <p>Calculate phonon lifetimes at the first 10 irreducible q-points and store in <code class="language-plaintext highlighter-rouge">gamma</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py --mesh 11 11 11 --br --write-gamma --gp 0 1 2 3 4 5 12 13 14 15
</code></pre></div></div> <h3 id="step-3-merge-gamma-files-after-completion">Step 3: Merge Gamma Files After Completion</h3> <p>Once all irreducible q-points (e.g., 0, 1, …, 310) are computed, merge them using:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>phono3py --fc3 --fc2 --mesh 11 11 11 --br --read-gamma
</code></pre></div></div> <p>If successful, the individual <code class="language-plaintext highlighter-rouge">.hdf5</code> files for each q-point can be safely deleted.</p>]]></content><author><name></name></author><category term="calculation"/><category term="vasp"/><category term="phono3py"/><category term="thermal-conductivity"/><category term="phonon"/><summary type="html"><![CDATA[A step-by-step guide to calculating lattice thermal conductivity using VASP and Phono3py, covering supercell generation, force calculations, and BTE solutions.]]></summary></entry><entry><title type="html">Landauer Theory for Electrons and Phonons</title><link href="https://lyushisyan.github.io/blog/2025/el-ph-landauer/" rel="alternate" type="text/html" title="Landauer Theory for Electrons and Phonons"/><published>2025-03-05T06:36:10+00:00</published><updated>2025-03-05T06:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2025/el-ph-landauer</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2025/el-ph-landauer/"><![CDATA[<p>In nanoscale thermal transport, how to accurately describe the heat flow of electrons or phonons between two reservoirs (thermal baths) from a microscopic perspective has become a research hotspot. Landauer theory was initially proposed to analyze electron transport in quantum wires, but later this concept was extended to bosonic systems like phonons, revealing the essence of transport in nano- or micro/nano-structures.</p> <ul> <li><strong>Electrons (fermions):</strong> Follow the Fermi-Dirac distribution. Each quantum state can accommodate at most two electrons (spin degeneracy). The chemical potential $\mu$ plays a key role in electron transport.</li> <li><strong>Phonons (bosons):</strong> Follow the Bose-Einstein distribution. Each quantum state can contain an unlimited number of phonons (no spin degeneracy, and typically $\mu = 0$).</li> </ul> <h2 id="1-landauer-theory-and-heat-flow-description">1. Landauer Theory and Heat Flow Description</h2> <p>The core idea of Landauer theory in heat transport is: <strong>the transport process can be understood as quantum states being scattered or transmitted through a relatively short device region</strong>, and the upper limit of transport is determined by the number of available modes (transport channels) and the probability that these modes can transmit through the device (i.e., transmission function $\tau(\mathbf{k})$).</p> <p>A simple physical picture is:</p> <ul> <li>The device is treated as a scattering region with different distribution functions in the left and right thermal reservoirs.</li> <li>For a wave vector $\mathbf{k}$ with $k_x &gt; 0$, particles propagate from left to right; conversely, if $k_x &lt; 0$, they move from right to left.</li> <li>The net heat flow equals “left-to-right heat flow” minus “right-to-left heat flow.”</li> </ul> <p>The heat flux density from the left to the right reservoir (unit: W/m$^{d-1}$) is generally written as:</p> \[J_{Q,L\to R}(T_1) = \frac{1}{L^d}\sum_p\sum_{\mathbf{k};k_x&gt;0} v_{gx,p}(\mathbf{k}) \tau_p(\mathbf{k}) [E_{i,p}(\mathbf{k}) - \mu][f_i^0(E_{i,p}(\mathbf{k}), T_1) + c_0]\] <p>where:</p> <ul> <li>$v_{gx,p}$: group velocity component in the $x$ direction;</li> <li>$\tau_p(\mathbf{k})$: transmission function;</li> <li>$E_{i,p}$: particle energy;</li> <li>$f_i^0$: equilibrium distribution function;</li> <li>$\mu$: chemical potential;</li> <li>$c_0$: zero-point energy correction.</li> </ul> <p>Similarly, the heat flow from right to left can be written, and the <strong>net heat flow</strong> is:</p> \[J_{Q,\text{net}} = \frac{1}{L^d}\sum_p\sum_{\mathbf{k};k_x&gt;0} v_{gx,p} \tau_p [E_{i,p} - \mu][f_i^0(T_1) - f_i^0(T_2)]\] <p>Note that the zero-point energy $c_0$ cancels out in the net heat flow and thus has no net contribution.</p> <h2 id="2-from-k-space-summation-to-integral-form">2. From k-Space Summation to Integral Form</h2> <p>For better analysis, the k-space summation is often converted into an integral (Landauer integral). The forms differ with dimensionality:</p> <h3 id="1d-system">1D System:</h3> \[J_{Q,\text{net}} = \sum_p \int_0^\infty \frac{v_{g,p} \tau_p [E_{i,p}(k) - \mu]}{2\pi} [f_i^0(T_1) - f_i^0(T_2)] dk\] <h3 id="2d-system">2D System:</h3> \[J_{Q,\text{net}} = \sum_p\int_{-\pi/2}^{\pi/2}\int_0^\infty\frac{v_{g,p}\cos\theta\tau_p [E_{i,p}(k)-\mu]}{4\pi^2}[f_i^0(T_1)-f_i^0(T_2)]kdkd\theta\] \[= \frac{1}{2\pi^2}\sum_p\int_0^\infty v_{g,p}\tau_p [E_{i,p}(k)-\mu] [f_i^0(T_1)-f_i^0(T_2)]kdk\] <h3 id="3d-system">3D System:</h3> \[J_{Q,\text{net}} = \sum_p\int_0^{2\pi}\int_{0}^{\pi/2}\int_0^\infty\frac{v_{g,p}\cos\theta\tau_p [E_{i,p}(k)-\mu]}{8\pi^3} [f_i^0(T_1)-f_i^0(T_2)]k^2dk\sin\theta d\theta d\varphi\] \[= \frac{1}{8\pi^2}\sum_p\int_0^\infty v_{g,p}\tau_p [E_{i,p}(k)-\mu] [f_i^0(T_1)-f_i^0(T_2)]k^2dk\] <p>Angle $\theta$ denotes the angle between the wave vector and the transport direction $x$. It’s often assumed that $\tau$ is direction-independent.</p> <p>By introducing the density of states (DOS), the k-space integral can be converted into an integral over frequency $\omega$ or energy $E$.</p> <h3 id="for-phonons">For Phonons:</h3> <p>Using frequency DOS $D(\omega)$ and $E = \hbar\omega$ with $\mu = 0$:</p> <ul> <li><strong>1D:</strong></li> </ul> \[J_{Q,\text{ph}} = \frac{1}{2} \sum_p \int_0^\infty v_{g,p} D_{\text{1D}}(\omega) \tau_p(\omega) \hbar\omega [f_{\text{BE}}^0(T_1) - f_{\text{BE}}^0(T_2)] d\omega\] <ul> <li><strong>2D:</strong></li> </ul> \[J_{Q,\text{ph}} = \frac{1}{\pi} \sum_p \int_0^\infty v_{g,p} D_{\text{2D}}(\omega) \tau_p(\omega) \hbar\omega [f_{\text{BE}}^0(T_1) - f_{\text{BE}}^0(T_2)] d\omega\] <ul> <li><strong>3D:</strong></li> </ul> \[J_{Q,\text{ph}} = \frac{1}{4} \sum_p \int_0^\infty v_{g,p} D_{\text{3D}}(\omega) \tau_p(\omega) \hbar\omega [f_{\text{BE}}^0(T_1) - f_{\text{BE}}^0(T_2)] d\omega\] <h3 id="for-electrons">For Electrons:</h3> <p>With nonzero chemical potential $\mu$ and energy DOS $D(E)$:</p> <ul> <li><strong>1D:</strong></li> </ul> \[J_{Q,\text{el}} = \frac{1}{2} \sum_p \int_0^\infty v_{g,p} D_{\text{1D}}(E) \tau_p(E) (E - \mu) [f_{\text{FD}}^0(T_1) - f_{\text{FD}}^0(T_2)] dE\] <ul> <li><strong>2D:</strong></li> </ul> \[J_{Q,\text{el}} = \frac{1}{\pi} \sum_p \int_0^\infty v_{g,p} D_{\text{2D}}(E) \tau_p(E) (E - \mu) [f_{\text{FD}}^0(T_1) - f_{\text{FD}}^0(T_2)] dE\] <ul> <li><strong>3D:</strong></li> </ul> \[J_{Q,\text{el}} = \frac{1}{4} \sum_p \int_0^\infty v_{g,p} D_{\text{3D}}(E) \tau_p(E) (E - \mu) [f_{\text{FD}}^0(T_1) - f_{\text{FD}}^0(T_2)] dE\] <h2 id="3-number-of-modes-and-half-wavelength-interpretation">3. Number of Modes and Half-Wavelength Interpretation</h2> <p>To combine quantitative analysis with intuitive understanding, the Landauer theory introduces the concept of <strong>number of modes</strong>.</p> <p>This idea can also be used to analyze <strong>heat flow</strong> $Q$ (in watts), which is the product of <strong>heat flux density</strong> $J_Q$ and “cross-sectional area”:</p> <ul> <li>For 1D: the area is 1 (or ignored);</li> <li>For 2D: the area is the contact width $W$;</li> <li>For 3D: the area is the contact cross-sectional area $A$.</li> </ul> <h3 id="31-general-expression-for-phonon-heat-flow">3.1 General Expression for Phonon Heat Flow</h3> <p>For phonons, the general expression for heat flow (or thermal power) is:</p> \[Q_{\text{ph}} = \frac{1}{2\pi} \int_0^\infty M(\omega)\tau(\omega)\hbar\omega [f_\text{BE}^0(T_1) - f_\text{BE}^0(T_2)]\,d\omega\] <p>where:</p> <ul> <li>$M(\omega)$ is the <strong>number of modes</strong>, representing the number of half-wavelengths (λ/2) of phonons per unit cross-sectional area at frequency $\omega$;</li> <li>$\tau(\omega)$ is the transmission function;</li> <li>$f_\text{BE}^0$ is the Bose-Einstein distribution function.</li> </ul> <h3 id="32-number-of-modes-in-different-dimensions">3.2 Number of Modes in Different Dimensions</h3> <p>The number of modes varies with dimensionality:</p> <ul> <li><strong>1D:</strong></li> </ul> \[M(\omega) = M_{\text{1D}}(\omega)\] <ul> <li><strong>2D:</strong></li> </ul> \[M(\omega) = W \cdot M_{\text{2D}}(\omega)\] <ul> <li><strong>3D:</strong></li> </ul> \[M(\omega) = A \cdot M_{\text{3D}}(\omega)\] <p>By comparing the relations $J_Q(1D)=Q$, $J_Q(2D)=Q/W$, $J_Q(3D)=Q/A$ with the expressions for heat flux density, we can derive the relationship between mode density $M(\omega)$ and density of states $D(\omega)$:</p> \[M_{\text{1D}}(\omega) = 1 = \pi v_g(\omega) D_{\text{1D}}(\omega)\] \[M_{\text{2D}}(\omega) = \frac{K(\omega)}{\pi} = \pi \cdot \frac{2v_g(\omega)}{\pi} D_{\text{2D}}(\omega)\] \[M_{\text{3D}}(\omega) = \frac{K^2(\omega)}{4\pi} = \pi \cdot \frac{v_g(\omega)}{2} D_{\text{3D}}(\omega)\] <p>Here, $v_g(\omega)$ is the group velocity, and $K(\omega)$ is the wave vector magnitude.</p> <p>We know the <strong>phonon DOS</strong> is:</p> \[D_{\text{1D}}(\omega) = \frac{1}{\pi v_g(\omega)}\] \[D_{\text{2D}}(\omega) = \frac{K(\omega)}{2\pi v_g(\omega)}\] \[D_{\text{3D}}(\omega) = \frac{K^2(\omega)}{2\pi^2 v_g(\omega)}\] <p>Substituting these into the expressions for number of modes:</p> \[M_{\text{1D}}(\omega) = \pi v_g(\omega) \cdot \frac{1}{\pi v_g(\omega)} = 1\] \[M_{\text{2D}}(\omega) = W \cdot \pi \cdot \left[ \frac{2v_g(\omega)}{\pi} \right] \cdot \frac{K(\omega)}{2\pi v_g(\omega)}\] \[M_{\text{3D}}(\omega) = A \cdot \pi \cdot \left[ \frac{v_g(\omega)}{2} \right] \cdot \frac{K^2(\omega)}{2\pi^2 v_g(\omega)}\] <h3 id="33-physical-meaning-of-spatially-averaged-group-velocity">3.3 Physical Meaning of Spatially Averaged Group Velocity</h3> <p>The terms in square brackets above represent the <strong>spatially averaged x-direction group velocity</strong> at a given frequency:</p> <ul> <li><strong>1D</strong>: Only motion along x-direction, so the average is $v_g$ itself;</li> <li><strong>2D</strong>: Average of $\cos\theta$ over a semicircle is $2/\pi$, thus $\langle v_{gx} \rangle = 2v_g/\pi$;</li> <li><strong>3D</strong>: Average of $\cos\theta$ over a hemisphere is $1/2$, thus $\langle v_{gx} \rangle = v_g/2$.</li> </ul> <h3 id="34-geometric-interpretation-using-half-wavelength">3.4 Geometric Interpretation Using Half-Wavelength</h3> <p>The number of modes $M(\omega)$ can also be interpreted geometrically as the number of half-wavelengths fitting into the cross-section:</p> <ul> <li>In <strong>1D</strong>, there’s only 1 propagating mode per frequency;</li> <li>In <strong>2D</strong>, the contact width $W$ can be divided into half-wavelength sections;</li> <li>In <strong>3D</strong>, the contact area $A$ is filled with these half-wave units.</li> </ul> \[(\text{1D}) :\quad M(\omega)=1\] \[(\text{2D}) :\quad M(\omega) = \frac{W}{\lambda/2}\] \[(\text{3D}) :\quad M(\omega) = \frac{A}{4/\pi(\lambda/2)^2}\] <h3 id="35-similar-analysis-for-electrons">3.5 Similar Analysis for Electrons</h3> <p>For electrons, a similar analysis gives the energy-integrated thermal flow as:</p> \[Q_{\text{el}} = \frac{1}{\pi\hbar} \int_0^\infty M(E) \tau(E)(E - \mu)[f_\text{FD}^0(T_1) - f_\text{FD}^0(T_2)]\,dE\] <p>According to Lundstrom and Jeong (2013), for electrons with a parabolic band, the number of modes is:</p> \[(\text{1D}) :\quad M_\text{1D}(E) = H(E - E_c)\] \[(\text{2D}) :\quad M(E) = W \cdot g_v \cdot \frac{\sqrt{2m^*(E - E_c)}}{\pi\hbar} \cdot H(E - E_c)\] \[(\text{3D}) :\quad M(E) = A \cdot g_v \cdot \frac{m^*(E - E_c)}{2\pi\hbar^2} \cdot H(E - E_c)\] <p>Where:</p> <ul> <li>$H(E - E_c)$ is the Heaviside function (only electrons above the conduction band minimum contribute);</li> <li>$g_v$ is valley degeneracy;</li> <li>$m^*$ is the effective mass;</li> <li>$E_c$ is the conduction band minimum.</li> </ul> <hr/> <h2 id="4-thermal-conductance-and-spectral-conductance">4. Thermal Conductance and Spectral Conductance</h2> <h3 id="41-thermal-conductance">4.1 Thermal Conductance</h3> <p><strong>Thermal conductance</strong> $G_Q$ is defined as heat flow per unit temperature difference:</p> \[G_Q = \frac{Q}{T_1 - T_2}\] <p>For small temperature differences, the differential form is:</p> \[G_Q(T) = \frac{Q(T + \delta T/2, T - \delta T/2)}{\delta T}\] <h4 id="for-phonons-1">For Phonons:</h4> \[G_Q(T) = \frac{1}{2\pi} \int_0^\infty M(\omega) \tau(\omega) \hbar\omega \frac{\partial f_\text{BE}^0}{\partial T} \, d\omega\] <h4 id="for-electrons-1">For Electrons:</h4> \[G_Q(T) = \frac{1}{\pi\hbar} \int_0^\infty M(E) \tau(E) (E - \mu) \frac{\partial f_\text{FD}^0}{\partial T} \, dE\] <p>Here, $M$ is the number of modes, $\tau$ is the transmission function, and $f^0$ is the equilibrium distribution.</p> <h3 id="42-spectral-conductance">4.2 Spectral Conductance</h3> <p>The integrand of $G_Q$ represents the <strong>contribution to thermal conductance at each frequency or energy</strong>, known as the <strong>spectral conductance</strong> $G_Q’$:</p> <ul> <li><strong>For Phonons:</strong></li> </ul> \[G_Q'(\omega, T) = \frac{1}{2\pi} M(\omega) \tau(\omega) \hbar\omega \frac{\partial f_\text{BE}^0}{\partial T}\] <ul> <li><strong>For Electrons:</strong></li> </ul> \[G_Q'(E, T) = \frac{1}{\pi\hbar} M(E) \tau(E) (E - \mu) \frac{\partial f_\text{FD}^0}{\partial T}\] <p>These functions show that the energy transport capacity depends on both the number of available modes $M$ and the thermal sensitivity $\partial f / \partial T$.</p> <p>To simplify analysis, one can define a <strong>normalized spectral conductance</strong> by dividing out constants like $k_B$, $M$, and assuming <strong>ideal transmission</strong> $\tau = 1$:</p> \[\tilde G_Q' = \frac{G_Q'}{C_0k_BM\tau} = (f_i^0)^2e^xx^2\] <p>with $x = \hbar\omega / k_B T$ as the dimensionless energy.</p> <p>In the <strong>phonon case</strong>, for low-frequency modes, the normalized conductance approaches 1 — indicating that <strong>each mode contributes equally</strong> at low frequencies, until the energy exceeds thermal energy $k_BT$.</p> <p>In the <strong>electron case</strong>, low-energy modes contribute little due to the <strong>Pauli exclusion principle</strong>: electrons must be thermally excited across the Fermi level, so most contribution comes from states near $E \approx \mu$.</p>]]></content><author><name></name></author><category term="physics"/><category term="landauer-theory"/><category term="phonon"/><category term="electron"/><category term="thermal-transport"/><category term="physics"/><summary type="html"><![CDATA[A detailed exploration of Landauer theory in nanoscale thermal transport, comparing electron and phonon transport mechanisms, mode counting, and spectral conductance.]]></summary></entry><entry><title type="html">First-Principles-Based PBTE Method</title><link href="https://lyushisyan.github.io/blog/2025/abinitio-bte/" rel="alternate" type="text/html" title="First-Principles-Based PBTE Method"/><published>2025-02-16T06:36:10+00:00</published><updated>2025-02-16T06:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2025/abinitio-bte</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2025/abinitio-bte/"><![CDATA[<p>In microscale and nanoscale heat conduction, size effects mainly involve two key length scales: <strong>phonon wavelength</strong> and <strong>mean free path (MFP)</strong>.</p> <ul> <li>If the system’s characteristic size is much larger than the phonon MFP, heat conduction is in the <strong>macroscopic diffusive regime</strong>, and the classical heat diffusion equation is applicable.</li> <li>If the size is comparable to the phonon MFP, <strong>classical size effects</strong> and <strong>ballistic phonon transport</strong> must be considered. In this case, the <strong>Boltzmann Transport Equation (BTE)</strong> should be used to describe energy transport.</li> <li>If the size further shrinks to the scale of the phonon wavelength, <strong>wave characteristics of phonons</strong> become important.</li> </ul> <p>The <strong>First-Principles Phonon Boltzmann Transport Equation (PBTE)</strong> method is essentially a combination of the following three techniques:</p> <ul> <li><strong>First-principles method (ab initio method)</strong>: A numerical method for solving the <strong>Schrödinger equation</strong>.</li> <li><strong>Lattice dynamics method</strong>: A method to compute phonon dispersion and relaxation times based on interatomic force constants (IFCs).</li> <li><strong>Boltzmann Transport Equation (BTE)</strong>: A heat transport model that uses phonon dispersion and relaxation time as inputs to calculate the system’s total thermal conductivity.</li> </ul> <h2 id="1-first-principles-methods">1. First-Principles Methods</h2> <p>First-principles (ab initio) methods refer to techniques that solve the electronic structure and atomic interactions of materials within the framework of quantum mechanics, using <strong>minimal empirical parameters</strong>. They are primarily based on numerical solutions to the Schrödinger equation, yielding properties such as ground-state electron density, band structure, total energy, and other physical quantities. In solid-state physics and materials science, first-principles methods are typically based on <strong>Density Functional Theory (DFT)</strong>. As the full many-body Schrödinger equation is difficult to solve directly, DFT provides an efficient way to handle many-body problems via the electron density and is widely applied to metals, semiconductors, insulators, molecules, and surfaces.</p> <h3 id="11-basic-concept-of-density-functional-theory">1.1 Basic Concept of Density Functional Theory</h3> <p>The core concepts of DFT originate from the Hohenberg-Kohn theorem and the Kohn-Sham equation:</p> <ol> <li>The <strong>Hohenberg-Kohn theorem</strong> states that all ground-state physical quantities of a system are functionals of the electron density $\rho(\mathbf{r})$, i.e., the Hamiltonian and energy of the system are uniquely determined by the electron density.</li> <li>The <strong>Kohn-Sham equation</strong> maps the real many-electron system to an auxiliary system of non-interacting electrons, using an appropriate <strong>exchange-correlation potential</strong> to approximate electron–electron interactions. The multi-body problem thus becomes solving a set of single-particle-like equations:</li> </ol> \[\left[ -\frac{\hbar^2}{2m}\nabla^2 + V_\text{ext}(\mathbf{r}) + V_\text{H}(\mathbf{r}) + V_\text{xc}(\mathbf{r}) \right] \phi_i(\mathbf{r}) = \epsilon_i \phi_i(\mathbf{r})\] <p>Where:</p> <ul> <li>$V_\text{ext}(\mathbf{r})$: Coulomb potential from atomic nuclei</li> <li>$V_\text{H}(\mathbf{r})$: classical Hartree potential</li> <li>$V_\text{xc}(\mathbf{r})$: exchange-correlation potential that includes all complex many-body effects</li> </ul> <p>In practice, one must choose an exchange-correlation functional (e.g., LDA, GGA, or hybrid functionals) and adopt a method to treat real and reciprocal space (e.g., pseudopotentials, PAW, APW+lo, etc.).</p> <h3 id="12-obtaining-interatomic-force-constants-ifcs-from-dft">1.2 Obtaining Interatomic Force Constants (IFCs) from DFT</h3> <p>A crucial step in thermal conductivity calculations is determining the <strong>interatomic force constants (IFCs)</strong> of the material. These constants are used to construct the dynamical matrix and calculate lattice dynamical properties such as phonon dispersion and phonon lifetimes. IFCs can be obtained from first-principles calculations using two main methods:</p> <h4 id="121-density-functional-perturbation-theory-dfpt">1.2.1 Density Functional Perturbation Theory (DFPT)</h4> <p>In the DFPT framework, small periodic perturbations are applied to the periodic structure, and the linearized Kohn-Sham equations are solved to obtain the first-, second-, or third-order responses of the potential energy with respect to atomic displacements.</p> <ul> <li>DFPT can directly calculate IFCs and phonon modes in $\mathbf{q}$-space.</li> <li>Both second-order (harmonic) and third-order (anharmonic) IFCs can be obtained for phonon dispersion and scattering analysis.</li> </ul> <h4 id="122-finite-displacement-method-fdm">1.2.2 Finite Displacement Method (FDM)</h4> <p>In this method, small displacements (e.g., 0.01 Å) are applied to atoms in a supercell, and the resulting changes in energy or forces are used to compute second-order and higher-order IFCs:</p> <ul> <li>A sufficiently large supercell is required to ensure negligible interaction across boundaries.</li> <li>Multiple configurations with different displacements must be computed to extract complete IFCs.</li> </ul> <p>Both methods rely on DFT-level force or energy calculations. Since phonon properties are sensitive to calculation accuracy, careful choices of exchange-correlation functional, plane-wave cutoff energy, and k-point mesh are necessary to ensure accurate IFCs.</p> <h2 id="2-harmonic-and-anharmonic-lattice-dynamics">2. Harmonic and Anharmonic Lattice Dynamics</h2> <p>In <strong>harmonic lattice dynamics</strong>, the second-order IFCs are used to obtain the phonon dispersion relation $\omega_\lambda(\mathbf{q})$. Once dispersion is known, specific heat of each phonon mode $\lambda$ can be computed. The phonon group velocity is defined as the gradient of the frequency with respect to wave vector: $\mathbf{v}<em>\lambda = \nabla</em>\mathbf{q} \omega_\lambda$ The <strong>relaxation time</strong> $\tau_\lambda$ is obtained through <strong>anharmonic lattice dynamics</strong>, which involves both second- and higher-order IFCs.</p> <h3 id="21-dispersion-relation">2.1 Dispersion Relation</h3> <p>For a periodic crystal with small displacements around equilibrium, the total potential energy $U$ can be expanded as a Taylor series:</p> \[U = U_0 + \frac{1}{2!} \sum_{ij}\sum_{\alpha\beta} \Phi_{ij}^{\alpha\beta} u_i^\alpha u_j^\beta + \frac{1}{3!} \sum_{ijk}\sum_{\alpha\beta\gamma} \Psi_{ijk}^{\alpha\beta\gamma} u_i^\alpha u_j^\beta u_k^\gamma + \mathcal{O}(u^4)\] <p>Where:</p> <ul> <li>$U_0$: potential energy at equilibrium</li> <li>$u_{i}^\alpha$: displacement of atom $i$ in direction $\alpha$</li> <li>$\Phi_{ij}^{\alpha\beta}$: second-order IFCs (harmonic)</li> <li>$\Psi_{ijk}^{\alpha\beta\gamma}$: third-order IFCs (anharmonic)</li> <li>$\mathcal{O}(u^4)$: higher-order terms</li> </ul> <p>Due to force equilibrium, first-order terms are absent. Neglecting higher-order terms leads to the harmonic approximation.</p> <p>If atom $i$ belongs to the $b$-th atom in the $l$-th unit cell and $j$ is in the $l’$-th cell, the equation of motion becomes:</p> \[m_b\frac{d^2 u_{lb}^\alpha (t)}{d t^2} = -\sum_{l'b',\beta} \Phi_{lb,l'b'}^{\alpha\beta} u_{l'b'}^{\beta} (t)\] <p>Assuming plane wave solutions:</p> \[u_{lb}^\alpha (t) = \frac{1}{\sqrt{m_b}}\Lambda_\lambda e_{b,\lambda}^\alpha e^{i(\mathbf q\cdot\mathbf R_l - \omega_\lambda t)}\] <p>Substituting gives the eigenvalue equation:</p> \[\omega_\lambda^2 \mathbf e _{b,\lambda} = \mathbf D_{bb'}^{\alpha\beta}(\textbf q) \textbf e_{b,\lambda}\] <p>Where the <strong>dynamical matrix</strong> is:</p> \[\mathbf D_{bb'}^{\alpha\beta}(\textbf q) =\frac{1}{\sqrt{m_bm_{b'}}}\sum_{l'}\Phi_{0b,l'b'}^{\alpha\beta} e^{i\mathbf q\cdot(\mathbf R_{l'} - \mathbf R_0)}\] <p>Solving gives the phonon dispersion $\omega_\lambda(\mathbf{q})$ and corresponding eigenvectors ${e_{b,\lambda}^\alpha}$.</p> <h3 id="22-phonon-scattering-mechanisms-and-relaxation-time">2.2 Phonon Scattering Mechanisms and Relaxation Time</h3> <p>In real materials, phonons have finite lifetimes due to various scattering mechanisms. Within the BTE framework, these are expressed as <strong>scattering rates</strong> $\Gamma_\lambda$ or equivalently <strong>relaxation times</strong> $\tau_\lambda$.</p> <h4 id="221-phonon-phonon-scattering">2.2.1 Phonon-Phonon Scattering</h4> <p>In nonmetals, the dominant scattering is <strong>phonon-phonon interactions</strong>, i.e., anharmonic lattice effects. Quantum mechanically, the crystal Hamiltonian is divided into harmonic and anharmonic parts. Third-order scattering (three-phonon processes) includes combination and splitting processes. Energy and momentum conservation must be satisfied (including Umklapp processes):</p> \[\Gamma_{\lambda\lambda'\lambda''}^{\pm} = \frac{\hbar\pi}{4}\begin{Bmatrix}n_{\lambda'}-n_{\lambda''} \\ n_{\lambda'} + n_{\lambda''}+1 \end{Bmatrix} \frac{\delta(\omega_\lambda\pm\omega_{\lambda'} - \omega_{\lambda''})}{\omega_{\lambda}\omega_{\lambda'}\omega_{\lambda''}}|V_{\lambda\lambda'\lambda''}^{\pm}|^2\Delta_{\mathbf{G}, \,\mathbf{q}\pm \mathbf{q}' - \mathbf{q}''}\] <h4 id="222-phonon-impurity-scattering">2.2.2 Phonon-Impurity Scattering</h4> <p>Caused by mass or bonding perturbations from impurities (e.g., isotopes, defects):</p> \[\Gamma_{\lambda\lambda'} = \frac{\pi \omega_\lambda^2}{2}\delta(\omega_\lambda - \omega_{\lambda'})\sum_bg(b) |\mathbf e_{b,\lambda}^*\cdot \mathbf e_{b,\lambda'}|^2\] <p>Where $g(b) = \sum_s f_s(b)(1 - \frac{m_{b,s}}{\overline{m}_b})^2$ and $\overline{m}<em>b = \sum_s f_s(b) m</em>{b,s}$.</p> <h2 id="3-thermal-conductivity-and-the-boltzmann-transport-equation-bte">3. Thermal Conductivity and the Boltzmann Transport Equation (BTE)</h2> <h3 id="31-thermal-conductivity">3.1 Thermal Conductivity</h3> <p>According to Fourier’s law, the thermal conductivity $\kappa$ characterizes the ability of a material to conduct heat:</p> \[\mathbf{J} = -\kappa \nabla T\] <p>Where $\mathbf{J}$ is the heat flux vector and $\nabla T$ is the temperature gradient. In anisotropic materials, $\kappa$ is a tensor.</p> <p>To predict $\kappa$ from phonon properties, one must use the BTE to describe the non-equilibrium phonon distribution under a small temperature gradient. Assuming steady-state and small gradients, the linearized BTE is:</p> \[-\mathbf{v}_\lambda \nabla T \frac{\partial n_\lambda^0}{\partial T} = \frac{n_\lambda'}{\tau_\lambda}\] <p>Where:</p> <ul> <li>$n_\lambda = n_\lambda^0 + n_\lambda’$ is the phonon distribution</li> <li>$n_\lambda^0$ is the equilibrium Bose–Einstein distribution</li> <li>$n_\lambda’$ is the perturbation from equilibrium</li> <li>$\tau_\lambda$ is the relaxation time</li> <li>$\mathbf{v}_\lambda$ is the group velocity of mode $\lambda$</li> </ul> <p>The Bose–Einstein distribution:</p> \[n_\lambda^0 = \frac{1}{\exp\left(\frac{\hbar \omega_\lambda}{k_B T}\right) - 1}\] <p>The heat flux contributed by phonons:</p> \[\mathbf{J} = \frac{1}{V} \sum_\lambda \hbar\omega_\lambda \mathbf{v}_\lambda n_\lambda\] <p>Where $V = N_0 \cdot \Omega$ is the total volume ($\Omega$ = unit cell volume, $N_0$ = number of $\mathbf{q}$-points). Comparing with Fourier’s law gives the thermal conductivity tensor:</p> \[\kappa^{\alpha\beta} = \frac{1}{V}\sum_\lambda \hbar\omega_\lambda \frac{\partial n_\lambda^0}{\partial T} v_\lambda^\alpha v_\lambda^\beta \tau_\lambda = \sum_\lambda c_\lambda v_\lambda^\alpha v_\lambda^\beta \tau_\lambda\] <p>Where $c_\lambda = \frac{\hbar\omega_\lambda}{V}\frac{\partial n_\lambda^0}{\partial T}$ is the mode heat capacity. For isotropic systems:</p> \[\kappa = \frac{1}{3V}\sum_\lambda \hbar\omega_\lambda \frac{\partial n_\lambda^0}{\partial T} |\mathbf{v}_\lambda|^2 \tau_\lambda\] <h3 id="32-single-mode-relaxation-time-approximation-smrta">3.2 Single-Mode Relaxation Time Approximation (SMRTA)</h3> <p>The SMRTA assumes that all phonon modes except mode $\lambda$ remain in equilibrium:</p> \[\begin{cases} n_\lambda = n_\lambda^0 + n_\lambda' \\ n_{\lambda'} = n_{\lambda'}^0 \\ n_{\lambda''} = n_{\lambda''}^0 \end{cases}\] <p>The SMRTA relaxation time becomes:</p> \[\frac{1}{\tau_\lambda^0} = \sum_{\lambda'\lambda''}^+ \Gamma_{\lambda\lambda'\lambda''}^+ + \sum_{\lambda'\lambda''}^- \frac{1}{2} \Gamma_{\lambda\lambda'\lambda''}^- + \sum_{\lambda'}\Gamma_{\lambda\lambda'}\] <p>Where superscript 0 indicates this is the zero-order approximation.</p> <h3 id="33-iterative-solution">3.3 Iterative Solution</h3> <p>To overcome SMRTA limitations, the <strong>Full Iterative Method</strong> solves the BTE self-consistently:</p> \[\begin{cases} n_\lambda = n_\lambda^0 + n_\lambda' \\ n_{\lambda'} = n_{\lambda'}^0 + n_{\lambda'}' \\ n_{\lambda''} = n_{\lambda''}^0 + n_{\lambda''}' \end{cases}\] <p><strong>Initial Guess</strong>: Use $\tau_\lambda^0$ from SMRTA.</p> <p><strong>Self-Consistent Iteration</strong>: Form a coupled system of equations for all $n_\lambda’$ and iterate until convergence.</p> <p>The relaxation time becomes:</p> \[\tau_\lambda = \tau_\lambda^0 + \tau_\lambda^0 \Delta_\lambda\] \[\Delta_\lambda = \sum_{\lambda'\lambda''}^+ \Gamma_{\lambda\lambda'\lambda''}^+ (\xi_{\lambda\lambda''}\tau_{\lambda''} - \xi_{\lambda\lambda'}\tau_{\lambda'}) \\ + \sum_{\lambda'\lambda''}^- \frac{1}{2} \Gamma_{\lambda\lambda'\lambda''}^-(\xi_{\lambda\lambda''}\tau_{\lambda''} + \xi_{\lambda\lambda'}\tau_{\lambda'}) \\+ \sum_{\lambda'}\Gamma_{\lambda\lambda'}\xi_{\lambda\lambda'}\tau_{\lambda'}\] <p>This method includes more detailed interactions and better captures <strong>phonon redistribution</strong> caused by <strong>Normal processes</strong>, especially in high thermal conductivity or low-temperature systems. However, it is also more computationally intensive.</p> <h2 id="4-computational-workflow-and-software">4. Computational Workflow and Software</h2> <p>The general workflow for calculating phonon thermal conductivity includes:</p> <h3 id="1-extract-interatomic-force-constants-ifcs">(1) Extract Interatomic Force Constants (IFCs)</h3> <p>IFCs are the basis for lattice dynamics and thermal transport. They can be obtained via:</p> <ul> <li><strong>Classical potentials</strong>: for simple structures with known potentials</li> <li><strong>Machine learning potentials (MLPs)</strong>: recent development balancing accuracy and efficiency</li> <li><strong>First-principles (DFT)</strong>: most common and accurate method without empirical parameters</li> </ul> <p>Two main extraction methods:</p> <ul> <li><strong>Finite Displacement Method</strong>: Apply small displacements in supercells and use numerical derivatives to obtain IFCs (supports classical/ML/DFT).</li> <li><strong>DFPT</strong>: Perturbative method within DFT framework; directly computes IFCs in reciprocal space.</li> </ul> <h3 id="2-truncation-and-symmetry-correction">(2) Truncation and Symmetry Correction</h3> <p>IFCs theoretically exist between all atomic pairs. In practice, a <strong>cutoff radius</strong> is applied. The impact of different cutoffs should be tested.</p> <p>Also, due to numerical noise and truncation, computed IFCs may violate <strong>translational invariance</strong> or crystal symmetry. These must be corrected to ensure accurate thermal conductivity.</p> <h3 id="3-compute-thermal-conductivity">(3) Compute Thermal Conductivity</h3> <p>With second- and third-order IFCs, combine <strong>anharmonic lattice dynamics</strong> and <strong>BTE</strong> using:</p> <ul> <li><strong>SMRTA</strong>: fast estimation</li> <li><strong>Full Iterative Solution</strong>: more accurate, especially for high-κ or low-T systems</li> </ul> <p>This method requires <strong>no fitting parameters</strong>, only the initial atomic structure. It is highly predictive and widely validated against experiments.</p> <h3 id="4-numerical-error-and-applicability">(4) Numerical Error and Applicability</h3> <p>Despite its strength, this method is still sensitive to:</p> <ul> <li>DFT convergence, functional choice, and displacement size</li> <li>IFC cutoff radius</li> <li>Brillouin zone integration grid (q-mesh)</li> </ul> <p>Nevertheless, PBTE is considered one of the most reliable methods for predicting lattice thermal conductivity. It not only yields <strong>total κ</strong>, but also <strong>mode-resolved contributions</strong>, enabling studies of interfacial thermal conductance and nanoscale transport.</p> <h3 id="5-software-and-interfaces">(5) Software and Interfaces</h3> <p>Several open-source packages support this workflow:</p> <ul> <li><strong>ShengBTE</strong></li> <li><strong>phono3py</strong></li> </ul> <p>These integrate well with major first-principles codes like:</p> <ul> <li><strong>VASP</strong></li> <li><strong>Quantum ESPRESSO</strong></li> <li><strong>ABINIT</strong></li> </ul> <p>They enable an end-to-end automated workflow from structure optimization to IFC extraction and thermal conductivity prediction.</p>]]></content><author><name></name></author><category term="calculation"/><category term="pbte"/><category term="phonon"/><category term="dft"/><category term="boltzmann-transport"/><category term="thermal-conductivity"/><summary type="html"><![CDATA[An introduction to the First-Principles Phonon Boltzmann Transport Equation (PBTE) method, covering DFT, lattice dynamics, and thermal conductivity calculations.]]></summary></entry><entry><title type="html">VASP Structure Optimization</title><link href="https://lyushisyan.github.io/blog/2024/vasp-relax/" rel="alternate" type="text/html" title="VASP Structure Optimization"/><published>2024-12-01T23:36:10+00:00</published><updated>2024-12-01T23:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2024/vasp-relax</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2024/vasp-relax/"><![CDATA[<h2 id="1-input-files">1. Input Files</h2> <p>The input files for VASP are the four basic files: <code class="language-plaintext highlighter-rouge">INCAR</code>, <code class="language-plaintext highlighter-rouge">POSCAR</code>, <code class="language-plaintext highlighter-rouge">POTCAR</code>, <code class="language-plaintext highlighter-rouge">KPOINTS</code>.</p> <h3 id="11-incar-parameter-settings">1.1 <code class="language-plaintext highlighter-rouge">INCAR</code> Parameter Settings</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>System <span class="o">=</span> Si-film    <span class="c"># System name, can be freely defined to identify the current calculation system.</span>

<span class="c"># Job Control</span>
ISTART <span class="o">=</span> 0          <span class="c"># Initial state setup:</span>
                    <span class="c"># 0 Start calculation from scratch.</span>
                    <span class="c"># 1 Read initial wavefunctions from WAVECAR file.</span>
                    <span class="c"># 2 Read wavefunctions and charge density from WAVECAR and CHGCAR files.</span>
ISPIN <span class="o">=</span> 1           <span class="c"># Spin polarization options:</span>
                    <span class="c"># 1 Non-spin-polarized (for non-magnetic materials).</span>
                    <span class="c"># 2 Spin-polarized (for magnetic materials).</span>
ICHARGE <span class="o">=</span> 2         <span class="c"># Initial charge density selection:</span>
                    <span class="c"># 2 Start from static charge density provided by POTCAR.</span>
                    <span class="c"># 1 Generate charge density from scratch.</span>
LWAVE <span class="o">=</span> .FALSE.     <span class="c"># Output WAVECAR file:</span>
                    <span class="c"># .TRUE. Output (store wavefunction data).</span>
                    <span class="c"># .FALSE. Do not output (save disk space).</span>
LCHARG <span class="o">=</span> .FALSE.    <span class="c"># Output CHGCAR file:</span>
                    <span class="c"># .TRUE. Output (store static charge density).</span>
                    <span class="c"># .FALSE. Do not output (save disk space).</span>
ISYM <span class="o">=</span> 0            <span class="c"># Symmetry settings:</span>
                    <span class="c"># 0 Disable symmetry (for systems with defects or asymmetric structures).</span>
                    <span class="c"># 1 or 2 Preserve symmetry operations.</span>

<span class="c"># Electronic Relaxation</span>
ENCUT <span class="o">=</span> 500         <span class="c"># Plane-wave cutoff energy (eV), determines calculation precision and efficiency.</span>
ISMEAR <span class="o">=</span> 0          <span class="c"># Smearing method:</span>
                    <span class="c"># -5 (tetrahedron method for metals), 0 (Gaussian smearing for semiconductors), 1 or 2 (Fermi smearing).</span>
SIGMA <span class="o">=</span> 0.05        <span class="c"># Smearing width (eV), recommended values: 0.01 ~ 0.1.</span>
EDIFF <span class="o">=</span> 1E-08       <span class="c"># SCF convergence criterion: stops if energy change between iterations is less than 1E-08 eV.</span>
NELMIN <span class="o">=</span> 6          <span class="c"># Minimum number of electronic iterations to ensure basic convergence.</span>
NELM <span class="o">=</span> 300          <span class="c"># Maximum number of electronic iterations to avoid iteration loops.</span>
GGA <span class="o">=</span> PE            <span class="c"># Functional choice, using PBE (Perdew-Burke-Ernzerhof) exchange-correlation functional.</span>
LREAL <span class="o">=</span> .FALSE.     <span class="c"># Reciprocal space calculations, increases precision but adds computational cost.</span>
ADDGRID <span class="o">=</span> .TRUE.    <span class="c"># Enable additional FFT grid for improved numerical accuracy.</span>
ALGO <span class="o">=</span> N            <span class="c"># Electronic relaxation algorithm:</span>
                    <span class="c"># Normal (standard mode), Fast, or VeryFast (accelerated modes).</span>
PREC <span class="o">=</span> Accurate     <span class="c"># Precision settings:</span>
                    <span class="c"># Accurate (high precision), Normal, or Low (for initial tests).</span>

<span class="c"># Ionic Relaxation</span>
ISIF <span class="o">=</span> 2            <span class="c"># Lattice optimization options:</span>
                    <span class="c"># 2 Optimize atomic positions only, keep lattice parameters fixed.</span>
                    <span class="c"># 3 Optimize both atomic positions and lattice shape.</span>
EDIFFG <span class="o">=</span> <span class="nt">-0</span>.01      <span class="c"># Ionic convergence criterion:</span>
                    <span class="c"># Negative values based on force (eV/\u00c5).</span>
                    <span class="c"># Positive values based on energy.</span>
IBRION <span class="o">=</span> 2          <span class="c"># Ionic relaxation algorithm:</span>
                    <span class="c"># 2 Conjugate gradient algorithm (suitable for most optimization tasks).</span>
POTIM <span class="o">=</span> 0.5         <span class="c"># Time step, controls optimization speed.</span>
NSW <span class="o">=</span> 200           <span class="c"># Maximum number of ionic steps.</span>

<span class="c"># Parallel Control</span>
NPAR <span class="o">=</span> 4            <span class="c"># FFT grid parallelization dimension (recommended: sqrt(total cores)).</span>
KPAR <span class="o">=</span> 2            <span class="c"># Number of parallel k-points (total cores should be divisible by NPAR \u00d7 KPAR \u00d7 NCORE).</span>
NCORE <span class="o">=</span> 12          <span class="c"># Number of cores per task.</span>
</code></pre></div></div> <p>For structural optimization, key parameters in <code class="language-plaintext highlighter-rouge">INCAR</code> include <code class="language-plaintext highlighter-rouge">IBRION</code>, <code class="language-plaintext highlighter-rouge">ISIF</code>, <code class="language-plaintext highlighter-rouge">NSW</code>, <code class="language-plaintext highlighter-rouge">EDIFF</code>, and <code class="language-plaintext highlighter-rouge">EDIFFG</code>.</p> <h4 id="111-common-ibrion-settings-and-applications">1.1.1 Common <code class="language-plaintext highlighter-rouge">IBRION</code> Settings and Applications</h4> <h5 id="1-single-point-energy-calculation">(1) Single-Point Energy Calculation</h5> <ul> <li><strong><code class="language-plaintext highlighter-rouge">IBRION = -1</code></strong><br/> <strong>Usage</strong>: Used for single-point energy calculations such as fixed lattice, electronic structure, or DOS analysis.<br/> <strong>Note</strong>: Avoid setting <code class="language-plaintext highlighter-rouge">NSW &gt; 0</code> to prevent wasting resources.</li> </ul> <h5 id="2-structure-optimization">(2) Structure Optimization</h5> <ul> <li> <p><strong><code class="language-plaintext highlighter-rouge">IBRION = 1</code></strong> (RMM-DIIS)<br/> <strong>Usage</strong>: Suitable for smooth potential energy surfaces in simple systems.<br/> <strong>Limitation</strong>: May encounter convergence issues for complex or unstable surfaces.</p> </li> <li> <p><strong><code class="language-plaintext highlighter-rouge">IBRION = 2</code></strong> (Conjugate Gradient)<br/> <strong>Usage</strong>: Most commonly used method, suitable for most systems.<br/> <strong>Advantage</strong>: Performs well for steep and complex surfaces.</p> </li> <li> <p><strong><code class="language-plaintext highlighter-rouge">IBRION = 3</code></strong> (Damped Molecular Dynamics)<br/> <strong>Usage</strong>: Stabilizes optimization paths that oscillate or diverge.</p> </li> </ul> <h5 id="3-molecular-dynamics">(3) Molecular Dynamics</h5> <ul> <li><strong><code class="language-plaintext highlighter-rouge">IBRION = 0</code></strong><br/> <strong>Usage</strong>: For studying dynamic behavior of systems at different temperatures, such as diffusion or vibrational modes.</li> </ul> <h5 id="4-phonon-calculations">(4) Phonon Calculations</h5> <p>a. <strong>Finite Difference Method</strong> <strong><code class="language-plaintext highlighter-rouge">IBRION = 5, 6</code></strong><br/> Calculates phonon modes using finite difference:</p> <ul> <li><strong><code class="language-plaintext highlighter-rouge">5</code></strong>: Without symmetry, suitable for defective or low-symmetry structures.</li> <li><strong><code class="language-plaintext highlighter-rouge">6</code></strong>: Exploits symmetry for efficient calculations in high-symmetry systems.</li> </ul> <p>b. <strong>Perturbation Theory (DFPT)</strong> <strong><code class="language-plaintext highlighter-rouge">IBRION = 7, 8</code></strong><br/> Calculates phonon modes using density functional perturbation theory (DFPT):</p> <ul> <li><strong><code class="language-plaintext highlighter-rouge">7</code></strong>: Without symmetry optimization, suitable for low-symmetry structures.</li> <li><strong><code class="language-plaintext highlighter-rouge">8</code></strong>: Utilizes symmetry for faster computation.</li> </ul> <h4 id="112-common-isif-settings-and-applications">1.1.2 Common <code class="language-plaintext highlighter-rouge">ISIF</code> Settings and Applications</h4> <ul> <li> <p>Default value (if not set): <code class="language-plaintext highlighter-rouge">ISIF = 2</code> (Optimize atomic positions only, keep lattice shape and volume fixed).</p> </li> <li>Special Cases: <ul> <li><code class="language-plaintext highlighter-rouge">IBRION = 0</code> (molecular dynamics) or <code class="language-plaintext highlighter-rouge">LHFCALC = .TRUE.</code> (hybrid functional): <code class="language-plaintext highlighter-rouge">ISIF = 0</code>.</li> </ul> </li> <li> <p><strong><code class="language-plaintext highlighter-rouge">ISIF = 2</code> (Most Common)</strong><br/> Optimizes atomic positions only, suitable for 2D materials, fixed lattice constants, or surface/interface systems.</p> </li> <li> <p><strong><code class="language-plaintext highlighter-rouge">ISIF = 3</code> (Bulk Optimization)</strong><br/> Optimizes atomic positions, lattice shape, and volume, suitable for bulk material relaxations.</p> </li> <li> <p><strong><code class="language-plaintext highlighter-rouge">ISIF = 4</code> (Fixed Volume Optimization)</strong><br/> Optimizes atomic positions and lattice shape while keeping the volume fixed, useful for pressure tests.</p> </li> <li> <p><strong><code class="language-plaintext highlighter-rouge">ISIF = 6</code> (Lattice-Only Optimization)</strong><br/> Optimizes lattice shape and volume without relaxing atomic positions, useful for testing lattice parameters.</p> </li> <li><strong><code class="language-plaintext highlighter-rouge">ISIF = 0</code> (Position Optimization, No Stress Calculation)</strong><br/> Optimizes atomic positions without calculating stress, for fixed cell optimizations.</li> </ul> <h4 id="113-recommended-settings-for-nsw-ediff-and-ediffg">1.1.3 Recommended Settings for <code class="language-plaintext highlighter-rouge">NSW</code>, <code class="language-plaintext highlighter-rouge">EDIFF</code>, and <code class="language-plaintext highlighter-rouge">EDIFFG</code></h4> <table> <thead> <tr> <th>Parameter</th> <th>Function</th> <th>Initial Optimization</th> <th>High-Precision Optimization</th> <th>Single Point</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">NSW</code></td> <td>Max ionic steps</td> <td>100-200</td> <td>200-500</td> <td>0</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">EDIFF</code></td> <td>SCF convergence (eV)</td> <td>1e-05</td> <td>1e-08</td> <td>1e-06</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">EDIFFG</code></td> <td>Ionic convergence (eV/\u00c5)</td> <td>-0.1</td> <td>-0.01</td> <td>Not required</td> </tr> </tbody> </table> <h3 id="12-example-poscar">1.2 Example <code class="language-plaintext highlighter-rouge">POSCAR</code></h3> <p>Below is an example <code class="language-plaintext highlighter-rouge">POSCAR</code> file describing the structure of bulk silicon:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Si-bulk   <span class="c"># System name, customizable</span>
1.0       <span class="c"># Global scaling factor (can be used to scale the lattice)</span>
   5.430    0.000    0.000  <span class="c"># Lattice vector a</span>
   0.000    5.430    0.000  <span class="c"># Lattice vector b</span>
   0.000    0.000    5.430  <span class="c"># Lattice vector c</span>
Si           <span class="c"># Atom types</span>
2            <span class="c"># Number of atoms for each type</span>
Direct       <span class="c"># Coordinate type (Direct: fractional; Cartesian: cartesian)</span>
  0.000  0.000  0.000  <span class="c"># Coordinates for atom 1</span>
  0.250  0.250  0.250  <span class="c"># Coordinates for atom 2</span>
</code></pre></div></div> <p>Example POSCAR File for Silicon Thin Film (Si-film):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Si Thin Film                            
   1.00000000000000     
     5.4299999999999997    0.0000000000000000    0.0000000000000000
     0.0000000000000000    5.4299999999999997    0.0000000000000000
     0.0000000000000000    0.0000000000000000   20.8599999999999994
   Si
    16
Selective dynamics  <span class="c"># Enable Selective Dynamics</span>
Direct
0.000000 0.000000 0.200000 F F F  <span class="c"># Fixed in all three directions</span>
0.500000 0.500000 0.200000 T T F  <span class="c"># Fixed in z-direction, free in x and y</span>
0.500000 0.000000 0.330153 T T T  <span class="c"># Free in all directions</span>
0.000000 0.500000 0.330153 T T T
0.250000 0.250000 0.265077 T T T
0.750000 0.750000 0.265077 T T T
0.750000 0.250000 0.395230 T T T
0.250000 0.750000 0.395230 T T T
0.000000 0.000000 0.460307 T T T
0.500000 0.500000 0.460307 T T T
0.500000 0.000000 0.590460 T T T
0.000000 0.500000 0.590460 T T T
0.250000 0.250000 0.525384 T T T
0.750000 0.750000 0.525384 T T T
0.750000 0.250000 0.655537 T T T
0.250000 0.750000 0.655537 T T T
</code></pre></div></div> <h3 id="13-kpoints-file">1.3 KPOINTS File</h3> <h4 id="1-monkhorst-pack-grid">(1) Monkhorst-Pack Grid</h4> <p>Monkhorst-Pack grids provide a uniform k-point distribution for periodic crystal calculations.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Automatic k-point generation   <span class="c"># Automatic k-point generation method (comment)</span>
0                              <span class="c"># Ignore total k-point count, use automatic generation</span>
Monkhorst-Pack                 <span class="c"># Choose Monkhorst-Pack grid</span>
4 4 4                          <span class="c"># Grid density in x, y, z directions</span>
0 0 0                          <span class="c"># No grid shift</span>
</code></pre></div></div> <p><strong>Use Case:</strong> Periodic crystals, optimization, DOS calculations, and electronic structure analysis.</p> <h4 id="2-gamma-grid">(2) Gamma Grid</h4> <p>Gamma grids center the k-point grid at the Gamma point, suitable for small or asymmetric lattices.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Automatic k-point generation   <span class="c"># Automatic k-point generation method (comment)</span>
0                              <span class="c"># Ignore total k-point count, use automatic generation</span>
Gamma                          <span class="c"># Choose Gamma-centered grid</span>
4 4 4                          <span class="c"># Grid density in x, y, z directions</span>
0 0 0                          <span class="c"># No grid shift</span>
</code></pre></div></div> <p><strong>Use Case:</strong> Small systems, asymmetric lattices, or fast calculation optimization tasks.</p> <h3 id="14-potcar-file-usage">1.4 POTCAR File Usage</h3> <p>POTCAR contains pseudopotential information required to describe atomic properties in the system.</p> <h4 id="vasp-provides-multiple-types-of-pseudopotentials">VASP Provides Multiple Types of Pseudopotentials:</h4> <ul> <li><strong>POT_GGA_PAW:</strong> PAW pseudopotentials with GGA functional.</li> <li><strong>POT_LDA_PAW:</strong> PAW pseudopotentials with LDA functional.</li> </ul> <h4 id="generating-the-potcar-file">Generating the POTCAR File:</h4> <p>For a system with atoms like Si and H, concatenate the pseudopotential files:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /POT_GGA_PAW/POTCAR_Si /POT_GGA_PAW/POTCAR_H <span class="o">&gt;</span> POTCAR
</code></pre></div></div> <ul> <li>Ensure the functional type in POTCAR matches the INCAR settings.</li> <li>Maintain the atom order in POTCAR consistent with the element order in POSCAR.</li> </ul> <h2 id="2-output-files">2. Output Files</h2> <h3 id="21-contcar-file">2.1 CONTCAR File</h3> <p><strong>Content:</strong> Optimized crystal structure, including updated atomic coordinates and lattice parameters. <strong>Format:</strong> Same as POSCAR, can directly serve as input for further calculations. <strong>Use Case:</strong></p> <ul> <li>Review the final optimized crystal structure.</li> <li>Use for further calculations (e.g., band structure, DOS).</li> </ul> <h3 id="22-oszicar-file">2.2 OSZICAR File</h3> <p><strong>Content:</strong></p> <ul> <li>Brief record of SCF (Self-Consistent Field) iteration energy changes.</li> <li>Energy (E0, dE) for each SCF step.</li> <li>Convergence information for SCF.</li> <li>Total energy changes per ion step during optimization.</li> </ul> <p><strong>Use Case:</strong></p> <ul> <li>Quickly check SCF calculation or optimization convergence.</li> <li>Decide if adjustments to EDIFF or optimization steps are necessary.</li> </ul> <h3 id="23-outcar-file">2.3 OUTCAR File</h3> <p><strong>Content:</strong></p> <ul> <li>Most detailed output file with complete calculation history.</li> <li>Includes parameters like electronic relaxation, iteration info, convergence criteria, etc.</li> <li>Energy, force, stress, atomic coordinates for each optimization step.</li> <li>Charge density info (if applicable).</li> </ul> <p><strong>Use Case:</strong></p> <ul> <li>Analyze convergence details and energy/force variations during optimization.</li> </ul> <h3 id="24-xdatcar-file">2.4 XDATCAR File</h3> <p><strong>Content:</strong></p> <ul> <li>Atomic coordinates for each ionic step during optimization or molecular dynamics (MD).</li> </ul> <p><strong>Use Case:</strong></p> <ul> <li>Analyze atomic movement paths during optimization.</li> <li>Perform trajectory analysis for structural changes.</li> </ul> <h3 id="25-vasprunxml-file">2.5 vasprun.xml File</h3> <p><strong>Content:</strong> XML-formatted record of all calculation data, suitable for parsing and post-processing.</p> <ul> <li>Includes electronic iteration, ionic optimization parameters, and results.</li> <li>Data for energy, force, stress, atomic coordinates, etc.</li> </ul> <p><strong>Use Case:</strong></p> <ul> <li>Extract key information using tools like pymatgen or ASE.</li> </ul> <h2 id="3-optimization-process-and-convergence-criteria">3. Optimization Process and Convergence Criteria</h2> <h3 id="31-optimization-process">3.1 Optimization Process</h3> <ol> <li><strong>Initialization of the Structure:</strong> <ul> <li>The initial structure is provided through the <code class="language-plaintext highlighter-rouge">POSCAR</code> file.</li> <li>The optimization conditions are configured using the <code class="language-plaintext highlighter-rouge">POTCAR</code>, <code class="language-plaintext highlighter-rouge">KPOINTS</code>, and <code class="language-plaintext highlighter-rouge">INCAR</code> files.</li> </ul> </li> <li><strong>Stepwise Optimization:</strong> <ul> <li>After each ionic optimization step, the total energy, atomic forces, and lattice stress of the system are recalculated.</li> <li>The optimization continues until convergence criteria (e.g., <code class="language-plaintext highlighter-rouge">EDIFFG</code>) are satisfied or the maximum number of steps (<code class="language-plaintext highlighter-rouge">NSW</code>) is reached.</li> </ul> </li> <li><strong>Structure Updates:</strong> <ul> <li>Intermediate results of each optimization step are stored in the <code class="language-plaintext highlighter-rouge">XDATCAR</code> file.</li> <li>The final structure after optimization is saved in the <code class="language-plaintext highlighter-rouge">CONTCAR</code> file.</li> </ul> </li> </ol> <h3 id="32-convergence-criteria">3.2 Convergence Criteria</h3> <p>The convergence of the optimization process can be determined using the following methods:</p> <ol> <li><strong><code class="language-plaintext highlighter-rouge">OUTCAR</code> File:</strong> <ul> <li> <table> <tbody> <tr> <td>Check whether the force on each atom is less than</td> <td><code class="language-plaintext highlighter-rouge">EDIFFG</code></td> <td>.</td> </tr> </tbody> </table> </li> <li>Verify whether the total energy change is less than <code class="language-plaintext highlighter-rouge">EDIFF</code>.</li> </ul> </li> <li><strong><code class="language-plaintext highlighter-rouge">OSZICAR</code> File:</strong> <ul> <li>Review the energy changes (<code class="language-plaintext highlighter-rouge">E0</code> and <code class="language-plaintext highlighter-rouge">dE</code>) during the SCF iterations.</li> <li>Determine whether the SCF process has stabilized and converged.</li> </ul> </li> <li><strong><code class="language-plaintext highlighter-rouge">CONTCAR</code> File:</strong> <ul> <li>Extract the final optimized atomic positions and lattice parameters.</li> <li>If the optimization has not converged, the <code class="language-plaintext highlighter-rouge">CONTCAR</code> file contains the structure from the last step.</li> </ul> </li> <li><strong>Using Tools:</strong> <ul> <li>Use tools like <code class="language-plaintext highlighter-rouge">pymatgen</code> or <code class="language-plaintext highlighter-rouge">ASE</code> to parse the <code class="language-plaintext highlighter-rouge">vasprun.xml</code> file and evaluate convergence.</li> </ul> </li> </ol> <h3 id="33-common-issues-and-solutions">3.3 Common Issues and Solutions</h3> <h4 id="331-scf-not-converging"><strong>3.3.1 SCF Not Converging</strong></h4> <p><strong>Issue:</strong> SCF iterations show energy oscillations or divergence.</p> <p><strong>Possible Causes:</strong></p> <ul> <li>The initial electronic density is poorly set.</li> <li>Insufficient cutoff energy (<code class="language-plaintext highlighter-rouge">ENCUT</code>).</li> </ul> <p><strong>Solutions:</strong></p> <ul> <li>Increase the maximum number of SCF iterations by setting <code class="language-plaintext highlighter-rouge">NELM=200</code>.</li> <li>Raise the cutoff energy: increase <code class="language-plaintext highlighter-rouge">ENCUT</code> to 520 eV or higher.</li> </ul> <h4 id="332-optimization-not-converging"><strong>3.3.2 Optimization Not Converging</strong></h4> <p><strong>Issue:</strong> Optimization reaches the maximum steps (<code class="language-plaintext highlighter-rouge">NSW</code>) but does not meet convergence criteria for force or energy.</p> <p><strong>Possible Causes:</strong></p> <ul> <li>The initial structure is far from the energy minimum.</li> <li>Convergence criteria (<code class="language-plaintext highlighter-rouge">EDIFFG</code>) are too strict.</li> <li>The optimization step size (<code class="language-plaintext highlighter-rouge">POTIM</code>) is too large.</li> </ul> <p><strong>Solutions:</strong></p> <ul> <li>Provide a reasonable initial structure or pre-optimize using external tools.</li> <li>Relax the convergence criteria: adjust <code class="language-plaintext highlighter-rouge">EDIFFG</code> from <code class="language-plaintext highlighter-rouge">-0.01</code> to <code class="language-plaintext highlighter-rouge">-0.02</code>.</li> <li>Reduce the optimization step size: adjust <code class="language-plaintext highlighter-rouge">POTIM</code> from <code class="language-plaintext highlighter-rouge">0.5</code> to <code class="language-plaintext highlighter-rouge">0.2</code>.</li> </ul> <h4 id="333-oscillations-during-optimization"><strong>3.3.3 Oscillations During Optimization</strong></h4> <p><strong>Issue:</strong> Energy and forces oscillate repeatedly during optimization, preventing stable convergence.</p> <p><strong>Possible Causes:</strong></p> <ul> <li>The optimization step size (<code class="language-plaintext highlighter-rouge">POTIM</code>) is too large.</li> <li>The optimization algorithm is unsuitable for the system.</li> </ul> <p><strong>Solutions:</strong></p> <ul> <li>Decrease the optimization step size: set <code class="language-plaintext highlighter-rouge">POTIM</code> to <code class="language-plaintext highlighter-rouge">0.2</code> or smaller.</li> <li>Change the optimization algorithm: <ul> <li>Use the conjugate gradient method by setting <code class="language-plaintext highlighter-rouge">IBRION=2</code>.</li> <li>Use damped molecular dynamics by setting <code class="language-plaintext highlighter-rouge">IBRION=3</code>.</li> </ul> </li> </ul> <h4 id="334-divergence-during-optimization"><strong>3.3.4 Divergence During Optimization</strong></h4> <p><strong>Issue:</strong> Severe deformation of the structure occurs during optimization, leading to significant energy increases.</p> <p><strong>Possible Causes:</strong></p> <ul> <li>Atomic distances are too short due to an unreasonable initial structure.</li> <li>Inadequate vacuum spacing (for low-dimensional systems such as thin films or nanostructures).</li> <li>Incorrect pseudopotential files.</li> </ul> <p><strong>Solutions:</strong></p> <ul> <li>Ensure reasonable initial atomic distances to avoid overly close atoms.</li> <li>Increase the vacuum spacing: for low-dimensional systems, set the vacuum layer thickness to at least 15 Å.</li> <li>Verify the <code class="language-plaintext highlighter-rouge">POTCAR</code> file to ensure the pseudopotential matches the atomic species.</li> </ul>]]></content><author><name></name></author><category term="calculation"/><category term="vasp"/><category term="dft"/><category term="structure-optimization"/><category term="calculation"/><summary type="html"><![CDATA[A comprehensive guide to structure optimization using VASP, covering input parameters, file formats, output analysis, and convergence strategies.]]></summary></entry><entry><title type="html">Numerical Methods for Density of States (DOS) Calculation</title><link href="https://lyushisyan.github.io/blog/2024/dos-method/" rel="alternate" type="text/html" title="Numerical Methods for Density of States (DOS) Calculation"/><published>2024-10-05T23:36:10+00:00</published><updated>2024-10-05T23:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2024/dos-method</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2024/dos-method/"><![CDATA[<p>One of the most critical quantities in lattice dynamics studies is the density of states (DOS), defined as the number of normal modes within the frequency range $\omega$ and $\omega + d\omega$.</p> <p>Expression for DOS:</p> \[\text{DOS}(\omega) = \frac{V}{8\pi^3} \sum_s \int \frac{dS_\omega}{|\Delta_{\boldsymbol k}\omega_s|}\] <p>where $S_\omega$ is the isofrequency surface.</p> <h2 id="root-sampling-method">Root Sampling Method</h2> <p>This is the simplest method (also known as the histogram statistical method):</p> \[\text{DOS}(\omega) = \frac{V}{8\pi^3} \sum_{\boldsymbol qs} \delta(\omega - \omega(\boldsymbol qs))\] <p>Using this method, we can count the number of modes within $\Delta\omega$ to obtain the density of states. However, this method requires a large number of $\boldsymbol k$ points in the Brillouin zone (the grid needs to be sufficiently dense) to achieve accurate results.</p> <h2 id="linear-extrapolation">Linear Extrapolation</h2> <p>The GR method divides the irreducible part of the first Brillouin zone into a uniform simple cubic grid with points $\boldsymbol k_c$ spaced by $2b$. Each point $\boldsymbol k_c$ is at the center of a small cube. From the small cube containing each $\boldsymbol k_c$, “all” frequencies are extracted, and the contributions from all cubes are summed to obtain the complete frequency distribution.</p> <p>The eigenfrequency at $\boldsymbol k_c$ is $\omega(\boldsymbol k_c)$. Assuming linear extrapolation is valid within each small cube, the isofrequency surface can be represented as parallel planes perpendicular to $\nabla\omega(\boldsymbol k_c)$. The volume element $dV$ between two such parallel planes corresponds to the number of frequencies within $\omega$ and $\omega + d\omega$. When $dV$ approaches zero, it can be approximated as</p> \[dV = Sd k_\perp\] <p>where $S$ is the cross-sectional area of the plane within the cube, and $d k_\perp$ is the thickness of the volume element.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/GR_method-480.webp 480w,/assets/img/blog/GR_method-800.webp 800w,/assets/img/blog/GR_method-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/GR_method.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure 1: Linear Extrapolation (GR method)</figcaption> </figure> </div> <p>Next, consider the cross-sectional area of this set of isofrequency planes within the cube. First, assume the three direction cosines of the normal to the isofrequency plane are $l_1$, $l_2$, and $l_3$, sorted in descending order.</p> <p>For any cross-section at a distance $h$ from $\boldsymbol k_c$, the cross-sectional area is denoted as $S(h)$. It must satisfy $S(h) = S(-h)$, so we only need to consider half of the cube ($h &gt; 0$).</p> <p>List in ascending order the distances of the four corners in this half to the plane passing through the cube center:</p> <p>\(h_1 = b|l_1 - l_2 - l_3|\) \(h_2 = b(l_1 - l_2 + l_3)\) \(h_3 = b(l_1 + l_2 - l_3)\) \(h_4 = b(l_1 + l_2 + l_3)\)</p> <p>In the first range $(0 \leq h \leq h_1)$, there are two possibilities depending on the sign of $(l_1 - l_2 - l_3)$. If the sign is positive, the cross-section is a parallelogram with an area of</p> \[S(h) = \frac{4b^2}{l_1}\] <p>If it is negative, the cross-section is a hexagon with an area of</p> \[S(h) = \frac{2b^2(l_1 l_2 + l_2 l_3 + l_3 l_1) - (h^2 + b^2)}{l_1 l_2 l_3}\] <p>In the second range $(h_1 \leq h \leq h_2)$, the shape is a pentagon, and its area is</p> \[S(h) = \frac{2b^2(l_1 l_2 + 3l_2 l_3 + l_3 l_1) - bh(-l_1 + l_2 + l_3) - \frac{1}{2}(h^2 + b^2)}{l_1 l_2 l_3}\] <p>In the third range $(h_2 \leq h \leq h_3)$, the shape is a quadrilateral, and its area is</p> \[S(h) = \frac{2b^2 l_3(l_1 + l_2) - bhl_3}{l_1 l_2 l_3}\] <p>In the fourth range $(h_3 \leq h \leq h_4)$, the shape is a quadrilateral, and its area is</p> \[S(h) = \frac{[b(l_1 + l_2 + l_3) - h]^2}{2l_1 l_2 l_3}\] <p>These expressions and their derivatives are continuous at their respective boundaries, and $S(h)$ integrated over the entire range yields the volume of the cube.</p> <p>Linear extrapolation over the entire cube provides the frequency variation:</p> \[\Omega = \omega(\boldsymbol k_c) \pm h\nabla\omega(\boldsymbol k_c)\] <p>where $0 \leq h \leq h_4$.</p> <p>To construct $\text{DOS}(\omega)$, we define a function $g_s(\boldsymbol k_c, \omega)$, which is the frequency distribution obtained by linearly extrapolating the entire cube centered at $\boldsymbol k_c$:</p> \[g_s(\boldsymbol k_c, \omega) = CW(\boldsymbol k_c) S_s(h)dh = CW(\boldsymbol k_c) S_s(w) \frac{d\omega}{|\nabla\omega(\boldsymbol k_c)|}\] <p>where $\omega(\boldsymbol k_c) - h_4\nabla\omega(\boldsymbol k_c) \leq \omega \leq \omega(\boldsymbol k_c) + h_4\nabla\omega(\boldsymbol k_c)$.</p> <p>Here, $C$ is a normalization constant, and $W(\boldsymbol k_c)$ is the symmetry-related weight factor for point $\boldsymbol k_c$.</p> <p>Finally, the complete density of states:</p> \[\text{DOS}(\omega) = \sum_{\boldsymbol k_c, s} g_s(\boldsymbol k_c, \omega)\] <p>The GR method has two practical challenges: (i) It requires the gradient $\nabla\omega(\boldsymbol k_c)$ to be calculated first. (ii) Since the cubes do not typically conform exactly to the Brillouin zone, it is necessary to determine the statistical weights of the cubes in the irreducible part of the zone.</p> <h2 id="generalization-of-linear-extrapolation">Generalization of Linear Extrapolation</h2> <p>The core idea of the GGR method is to use an affine transformation to convert the parallelepiped-shaped Brillouin zone into a cube, enabling the original GR method to be applied to any lattice.</p> <p>The BZ is a parallelepiped defined by three reciprocal vectors $\boldsymbol b_i (i = 1, 2, 3)$. The $\boldsymbol k$ points are uniformly distributed along the three basis vectors $\boldsymbol b_i$.</p> <p>An affine transformation changes the $\boldsymbol k$ basis of the parallelepiped BZ to the $\boldsymbol t = (t_1, t_2, t_3)$ cubic basis:</p> \[\boldsymbol k = \boldsymbol b_1 t_1 + \boldsymbol b_2 t_2 + \boldsymbol b_3 t_3\] <p>where $t_1, t_2, t_3 \in [0, 1]$.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/GGR-480.webp 480w,/assets/img/blog/GGR-800.webp 800w,/assets/img/blog/GGR-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/GGR.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure 2: Generalization of Linear Extrapolation (GGR method)</figcaption> </figure> </div> <p>The volume elements of the two bases satisfy $dV_k = \det(B)dV_t = \Omega dV_t$, where $\Omega$ is the volume of the BZ.</p> <p>We transform $\text{DOS}(\omega)$ (the integral over the isofrequency surface $S_\omega$) from the $\boldsymbol k$ basis to the $\boldsymbol t$ cubic basis:</p> \[\text{DOS}(\omega) = \frac{1}{\Omega} \sum_s \int_{S_\omega} \frac{dS_k}{|\Delta_{\boldsymbol k}\omega_s|} = \sum_s \int_{S_\omega} \frac{dS_t}{|\Delta_{\boldsymbol t}\omega_s|}\] <h2 id="linear-interpolation">Linear Interpolation</h2> <p>The irreducible part is divided into multiple tetrahedra of equal volume. The phonon frequency at each vertex of the tetrahedron is known, and the phonon frequency $\nabla\omega(\boldsymbol k)$ at any position inside the tetrahedron can be obtained by linear interpolation:</p> \[\omega(\boldsymbol k) = a_1\omega(\boldsymbol k_1) + a_2\omega(\boldsymbol k_2) + a_3\omega(\boldsymbol k_3) + a_4\omega(\boldsymbol k_4)\] <p>where $a_i$ are the weighting coefficients at the vertices of the tetrahedron, satisfying $a_1 + a_2 + a_3 + a_4 = 1$. These weights depend on the position of point $\boldsymbol k$ inside the tetrahedron.</p> <p>The tetrahedron method only requires the distribution of $\omega(\boldsymbol k_i)$ on a coarse grid and does not require frequency gradients (group velocity).</p> <p>However, at band crossings or degenerate points, linear interpolation introduces errors.</p>]]></content><author><name></name></author><category term="calculation"/><category term="density-of-states"/><category term="phonon"/><category term="lattice-dynamics"/><category term="numerical-methods"/><summary type="html"><![CDATA[An overview of numerical techniques for calculating Density of States (DOS), including Root Sampling, Linear Extrapolation (GR/GGR methods), and Linear Interpolation.]]></summary></entry><entry><title type="html">Phonon Dispersion Calculation of Silicon Using QE</title><link href="https://lyushisyan.github.io/blog/2024/qe-disp-si/" rel="alternate" type="text/html" title="Phonon Dispersion Calculation of Silicon Using QE"/><published>2024-04-05T23:36:10+00:00</published><updated>2024-04-05T23:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2024/qe-disp-si</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2024/qe-disp-si/"><![CDATA[<p>Phonon dispersion in Quantum Espresso is calculated using the <code class="language-plaintext highlighter-rouge">ph.x</code> program, based on Density Functional Perturbation Theory (DFPT). This article demonstrates the calculation process using monocrystalline silicon (Si) as an example.</p> <h2 id="step-1-pwx">Step 1 pw.x</h2> <p>Perform SCF calculation using <code class="language-plaintext highlighter-rouge">pw.x</code>.</p> <ul> <li><strong>SCF Input File (<code class="language-plaintext highlighter-rouge">pw.scf.Si.in</code>)</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;control
  calculation <span class="o">=</span> <span class="s1">'scf'</span>
  restart_mode <span class="o">=</span> <span class="s1">'from_scratch'</span>
  pseudo_dir <span class="o">=</span> <span class="s1">'./pseudos/'</span>
  outdir <span class="o">=</span> <span class="s1">'./out/'</span>
  prefix <span class="o">=</span> <span class="s1">'Si'</span>
/
&amp;system
  ibrav <span class="o">=</span> 2
  celldm<span class="o">(</span>1<span class="o">)</span> <span class="o">=</span> 10.20
  nat <span class="o">=</span> 2
  ntyp <span class="o">=</span> 1
  ecutwfc <span class="o">=</span> 16
/
&amp;electrons
  mixing_mode <span class="o">=</span> <span class="s1">'plain'</span>
  mixing_beta <span class="o">=</span> 0.7
  conv_thr <span class="o">=</span> 1.0e-8
/
ATOMIC_SPECIES
  Si 28.0855 Si.vbc.UPF
ATOMIC_POSITIONS
  Si 0.00 0.00 0.00
  Si 0.25 0.25 0.25
K_POINTS <span class="o">{</span>automatic<span class="o">}</span>
  8 8 8 0 0 0
</code></pre></div></div> <ul> <li><strong>Execute SCF Calculation</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun <span class="nt">-np</span> 4 pw.x <span class="nt">-i</span> pw.scf.Si.in <span class="o">&gt;</span> pw.scf.Si.out
</code></pre></div></div> <h2 id="step-2-phx">Step 2 ph.x</h2> <p>Compute dynamical matrices on a uniform <strong>q-point</strong> grid using <code class="language-plaintext highlighter-rouge">ph.x</code>.</p> <ul> <li><strong>Input File (<code class="language-plaintext highlighter-rouge">ph.Si.in</code>)</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;INPUTPH
  tr2_ph <span class="o">=</span> 1d-14
  amass<span class="o">(</span>1<span class="o">)</span> <span class="o">=</span> 28.0855
  ldisp <span class="o">=</span> .true.
  nq1 <span class="o">=</span> 4
  nq2 <span class="o">=</span> 4
  nq3 <span class="o">=</span> 4
  outdir <span class="o">=</span> <span class="s1">'./out/'</span>
  prefix <span class="o">=</span> <span class="s1">'Si'</span>
  fildyn <span class="o">=</span> <span class="s1">'Si.dyn'</span>
/
</code></pre></div></div> <ul> <li><strong>Execute Calculation</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun <span class="nt">-np</span> 4 ph.x <span class="nt">-i</span> ph.Si.in <span class="o">&gt;</span> ph.Si.out
</code></pre></div></div> <ul> <li><strong>Output Files</strong></li> </ul> <p><strong><code class="language-plaintext highlighter-rouge">Si.dyn0</code></strong> contains the coordinates of the q-point grid.<br/> <strong><code class="language-plaintext highlighter-rouge">Si.dyn1-N</code></strong> contains force constants ( C(q_n) ), where ( n = 1,…N ), with ( N ) being the number of irreducible q-points in the Brillouin zone.</p> <h2 id="step-3-q2rx">Step 3 q2r.x</h2> <p>Use <code class="language-plaintext highlighter-rouge">q2r.x</code> to perform an inverse Fourier transform of the force constants in q-space to obtain real-space force constants.</p> <ul> <li><strong>Input File (<code class="language-plaintext highlighter-rouge">q2r.Si.in</code>)</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;INPUT
  fildyn <span class="o">=</span> <span class="s1">'Si.dyn'</span>
  zasr <span class="o">=</span> <span class="s1">'simple'</span> 
  flfrc <span class="o">=</span> <span class="s1">'Si444.fc'</span>
/
</code></pre></div></div> <ul> <li><strong>Execute Calculation</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun <span class="nt">-np</span> 4 q2r.x <span class="nt">-i</span> q2r.Si.in <span class="o">&gt;</span> q2r.Si.out
</code></pre></div></div> <ul> <li><strong>Output File</strong></li> </ul> <p><strong><code class="language-plaintext highlighter-rouge">Si444.fc</code></strong> contains real-space force constants for a <strong>4×4×4</strong> supercell.</p> <h2 id="step-4-matdynx">Step 4 matdyn.x</h2> <p>Use <code class="language-plaintext highlighter-rouge">matdyn.x</code> to perform a Fourier transform on real-space components to obtain the dynamical matrix and eigenvalues (frequencies) at arbitrary q-points.</p> <ul> <li><strong>Input File (<code class="language-plaintext highlighter-rouge">matdyn.Si.in</code>)</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;INPUT
  asr <span class="o">=</span> <span class="s1">'simple'</span>  
  flfrc <span class="o">=</span> <span class="s1">'Si444.fc'</span>
  flfrq <span class="o">=</span> <span class="s1">'Si.freq'</span>  
  flvec <span class="o">=</span> <span class="s1">'Si.modes'</span> 
  q_in_band_form <span class="o">=</span> .true.
/
6
0.000 0.000 0.000   50
0.500 0.000 0.500   50
0.625 0.250 0.625   1
0.375 0.375 0.750   50
0.000 0.000 0.000   50
0.500 0.500 0.500    1
</code></pre></div></div> <ul> <li><strong>Execute Calculation</strong></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun <span class="nt">-np</span> 4 matdyn.x <span class="nt">-i</span> matdyn.Si.in <span class="o">&gt;</span> matdyn.Si.out
</code></pre></div></div> <p>Then, use the resulting <code class="language-plaintext highlighter-rouge">Si.freq.gp</code> file to generate plots.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/Si-bulk-qe-480.webp 480w,/assets/img/blog/Si-bulk-qe-800.webp 800w,/assets/img/blog/Si-bulk-qe-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/Si-bulk-qe.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure: Phonon Dispersion in Silicon</figcaption> </figure> </div>]]></content><author><name></name></author><category term="calculation"/><category term="quantum-espresso"/><category term="phonon"/><category term="dfpt"/><category term="silicon"/><category term="calculation"/><summary type="html"><![CDATA[A step-by-step tutorial on calculating phonon dispersion for Silicon using Density Functional Perturbation Theory (DFPT) in Quantum Espresso.]]></summary></entry><entry><title type="html">Self-Consistent Energy Calculations with QE</title><link href="https://lyushisyan.github.io/blog/2024/qe-scf/" rel="alternate" type="text/html" title="Self-Consistent Energy Calculations with QE"/><published>2024-03-16T23:36:10+00:00</published><updated>2024-03-16T23:36:10+00:00</updated><id>https://lyushisyan.github.io/blog/2024/qe-scf</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2024/qe-scf/"><![CDATA[<p>The calculations handled by <code class="language-plaintext highlighter-rouge">pw.x</code> include seven types, specified in the input file with <code class="language-plaintext highlighter-rouge">calculation</code>:</p> <ul> <li><code class="language-plaintext highlighter-rouge">'scf'</code>: Self-consistent field (SCF) calculation, solving the differential-integral Kohn-Sham equations iteratively. Convergence is achieved when the change in charge density is small enough, resulting in self-consistent charge.</li> <li><code class="language-plaintext highlighter-rouge">'nscf'</code>: Non-self-consistent calculation, usually performed on a denser k-space grid for integrations like DOS. Uses self-consistent charge and computes properties for additional k-points.</li> <li><code class="language-plaintext highlighter-rouge">'bands'</code>: Another non-self-consistent calculation where k-points follow specific paths in 3D k-space.</li> <li><code class="language-plaintext highlighter-rouge">'relax'</code>: A series of SCF calculations for ionic relaxation based on Hellman-Feynman forces, optimizing atomic coordinates to minimize forces while keeping the cell fixed.</li> <li><code class="language-plaintext highlighter-rouge">'vc-relax'</code>: Similar to relax but allows the cell to vary based on stress calculations.</li> <li><code class="language-plaintext highlighter-rouge">'md'</code>: Molecular dynamics simulation, treating the ion-electron interaction as a potential for ionic motion and solving the classical equations of motion for ions.</li> <li><code class="language-plaintext highlighter-rouge">'vc-md'</code>: Molecular dynamics with cell variation.</li> </ul> <h2 id="input-file">Input File</h2> <p>In QE input files, there are <code class="language-plaintext highlighter-rouge">NAMELISTS</code> and <code class="language-plaintext highlighter-rouge">INPUT_CARDS</code>.</p> <p><code class="language-plaintext highlighter-rouge">PWscf</code> requires three mandatory <code class="language-plaintext highlighter-rouge">NAMELISTS</code>:</p> <ol> <li><code class="language-plaintext highlighter-rouge">&amp;CONTROL</code>: Specifies the calculation flow.</li> <li><code class="language-plaintext highlighter-rouge">&amp;SYSTEM</code>: Describes the system.</li> <li><code class="language-plaintext highlighter-rouge">&amp;ELECTRONS</code>: Defines the algorithm for solving the Kohn-Sham equations.</li> </ol> <p>Two additional <code class="language-plaintext highlighter-rouge">NAMELISTS</code>, <code class="language-plaintext highlighter-rouge">&amp;IONS</code> and <code class="language-plaintext highlighter-rouge">&amp;CELLS</code>, are needed for specific calculations.</p> <p>The three mandatory <code class="language-plaintext highlighter-rouge">INPUT_CARDS</code> in <code class="language-plaintext highlighter-rouge">PWscf</code> are <code class="language-plaintext highlighter-rouge">ATOMIC_SPECIES</code>, <code class="language-plaintext highlighter-rouge">ATOMIC_POSITIONS</code>, and <code class="language-plaintext highlighter-rouge">K_POINTS</code>. Other information may be required depending on the calculation.</p> <h3 id="example-self-consistent-calculation-for-silicon-pwscfsiliconin">Example: Self-Consistent Calculation for Silicon (<code class="language-plaintext highlighter-rouge">pw.scf.silicon.in</code>)</h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp;CONTROL
<span class="nv">calculation</span><span class="o">=</span><span class="s1">'scf'</span>,   <span class="c"># Self-consistent field calculation</span>
<span class="nv">prefix</span><span class="o">=</span><span class="s1">'silicon'</span>,   <span class="c"># Prefix for output files</span>
<span class="nv">pseudo_dir</span><span class="o">=</span><span class="s1">'./pseudo/'</span>,   <span class="c"># Directory for pseudopotentials</span>
<span class="nv">outdir</span><span class="o">=</span><span class="s1">'./out/'</span>,   <span class="c"># Directory for output files</span>
/
&amp;SYSTEM
<span class="nv">ibrav</span><span class="o">=</span>2,   <span class="c"># Bravais lattice type (FCC)</span>
celldm<span class="o">(</span>1<span class="o">)=</span>10.2625,   <span class="c"># Lattice constant (in Bohr, 1 Bohr = 0.529 Å)</span>
<span class="nv">nat</span><span class="o">=</span>2,   <span class="c"># Number of atoms</span>
<span class="nv">ntyp</span><span class="o">=</span>1,   <span class="c"># Number of atomic types</span>
<span class="nv">ecutwfc</span><span class="o">=</span>60.0,   <span class="c"># Wavefunction cutoff energy (in Ry, 1 Ry = 13.606 eV)</span>
<span class="nv">ecutrho</span><span class="o">=</span>720.0,   <span class="c"># Charge density cutoff energy</span>
/
&amp;ELECTRONS
<span class="nv">mixing_beta</span><span class="o">=</span>0.7,   <span class="c"># Mixing ratio for charge density (default 0.7)</span>
<span class="nv">conv_thr</span><span class="o">=</span>1d-8,   <span class="c"># Convergence threshold for SCF (default 1d-6)</span>
/
ATOMIC_SPECIES
Si 28.0855 Si.pbe-rrkj.UPF   <span class="c"># Pseudopotential</span>
ATOMIC_POSITIONS <span class="o">(</span>alat<span class="o">)</span>   <span class="c"># Atomic positions (alat = lattice parameter)</span>
Si 0.00 0.00 0.00
Si 0.25 0.25 0.25
K_POINTS automatic  <span class="c"># Automatic k-point grid</span>
4 4 4 1 1 1
</code></pre></div></div> <ul> <li><code class="language-plaintext highlighter-rouge">ibrav</code>: Values from 1–14 correspond to the 14 Bravais lattices; 0 for free lattice.</li> <li><code class="language-plaintext highlighter-rouge">ecutwfc</code>: Suggested value depends on the pseudopotential used.</li> <li><code class="language-plaintext highlighter-rouge">ecutrho</code>: Related to <code class="language-plaintext highlighter-rouge">ecutwfc</code>: <ul> <li>For NC pseudopotentials, this is 4× <code class="language-plaintext highlighter-rouge">ecutwfc</code>.</li> <li>For US pseudopotentials, this is 8–12× <code class="language-plaintext highlighter-rouge">ecutwfc</code>.</li> <li>For PAW pseudopotentials, this is 4× <code class="language-plaintext highlighter-rouge">ecutwfc</code>.</li> </ul> </li> <li>File saved as <code class="language-plaintext highlighter-rouge">pw.scf.silicon.in</code>.</li> <li>Suggested settings: <code class="language-plaintext highlighter-rouge">occupations='smearing', smearing='gaussian', degauss=1d-9</code> for Gaussian smearing.</li> </ul> <p>Refer to the <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html"><strong>PWscf User Manual</strong></a> for a detailed explanation.</p> <h2 id="execution">Execution</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mpirun <span class="nt">-np</span> 4 pw.x <span class="nt">-inp</span> pw.scf.silicon.in <span class="o">&gt;</span> pw.scf.silicon.out
</code></pre></div></div> <h2 id="output-file">Output File</h2> <p>Check the output file <code class="language-plaintext highlighter-rouge">pw.scf.silicon.out</code> for convergence details:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-e</span> <span class="s1">'total energy'</span> <span class="nt">-e</span> estimate pw.scf.silicon.out
</code></pre></div></div> <p>Example:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Self-consistent</span><span class="w"> </span><span class="err">Calculation</span><span class="w">

</span><span class="err">iteration</span><span class="w"> </span><span class="err">#</span><span class="w">  </span><span class="mi">1</span><span class="w">     </span><span class="err">ecut=</span><span class="w">    </span><span class="mf">16.00</span><span class="w"> </span><span class="err">Ry</span><span class="w">     </span><span class="err">beta=</span><span class="w"> </span><span class="mf">0.70</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">1.00E-02</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">2.0</span><span class="w">
</span><span class="err">Threshold</span><span class="w"> </span><span class="err">(ethr)</span><span class="w"> </span><span class="err">on</span><span class="w"> </span><span class="err">eigenvalues</span><span class="w"> </span><span class="err">was</span><span class="w"> </span><span class="err">too</span><span class="w"> </span><span class="err">large:</span><span class="w">
</span><span class="err">Diagonalizing</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">lowered</span><span class="w"> </span><span class="err">threshold</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">6.93E-04</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">1.0</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">cpu</span><span class="w"> </span><span class="err">time</span><span class="w"> </span><span class="err">spent</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">now</span><span class="w"> </span><span class="err">is</span><span class="w">        </span><span class="mf">0.3</span><span class="w"> </span><span class="err">secs</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w">              </span><span class="err">=</span><span class="w">     </span><span class="mf">-15.83539933</span><span class="w"> </span><span class="err">Ry</span><span class="w">
</span><span class="err">estimated</span><span class="w"> </span><span class="err">scf</span><span class="w"> </span><span class="err">accuracy</span><span class="w">    </span><span class="err">&lt;</span><span class="w">       </span><span class="mf">0.06071141</span><span class="w"> </span><span class="err">Ry</span><span class="w">

</span><span class="err">iteration</span><span class="w"> </span><span class="err">#</span><span class="w">  </span><span class="mi">2</span><span class="w">     </span><span class="err">ecut=</span><span class="w">    </span><span class="mf">16.00</span><span class="w"> </span><span class="err">Ry</span><span class="w">     </span><span class="err">beta=</span><span class="w"> </span><span class="mf">0.70</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">7.59E-04</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">1.0</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">cpu</span><span class="w"> </span><span class="err">time</span><span class="w"> </span><span class="err">spent</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">now</span><span class="w"> </span><span class="err">is</span><span class="w">        </span><span class="mf">0.4</span><span class="w"> </span><span class="err">secs</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w">              </span><span class="err">=</span><span class="w">     </span><span class="mf">-15.83851631</span><span class="w"> </span><span class="err">Ry</span><span class="w">
</span><span class="err">estimated</span><span class="w"> </span><span class="err">scf</span><span class="w"> </span><span class="err">accuracy</span><span class="w">    </span><span class="err">&lt;</span><span class="w">       </span><span class="mf">0.00218630</span><span class="w"> </span><span class="err">Ry</span><span class="w">

</span><span class="err">iteration</span><span class="w"> </span><span class="err">#</span><span class="w">  </span><span class="mi">3</span><span class="w">     </span><span class="err">ecut=</span><span class="w">    </span><span class="mf">16.00</span><span class="w"> </span><span class="err">Ry</span><span class="w">     </span><span class="err">beta=</span><span class="w"> </span><span class="mf">0.70</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">2.73E-05</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">2.3</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">cpu</span><span class="w"> </span><span class="err">time</span><span class="w"> </span><span class="err">spent</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">now</span><span class="w"> </span><span class="err">is</span><span class="w">        </span><span class="mf">0.4</span><span class="w"> </span><span class="err">secs</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w">              </span><span class="err">=</span><span class="w">     </span><span class="mf">-15.83897965</span><span class="w"> </span><span class="err">Ry</span><span class="w">
</span><span class="err">estimated</span><span class="w"> </span><span class="err">scf</span><span class="w"> </span><span class="err">accuracy</span><span class="w">    </span><span class="err">&lt;</span><span class="w">       </span><span class="mf">0.00007075</span><span class="w"> </span><span class="err">Ry</span><span class="w">

</span><span class="err">iteration</span><span class="w"> </span><span class="err">#</span><span class="w">  </span><span class="mi">4</span><span class="w">     </span><span class="err">ecut=</span><span class="w">    </span><span class="mf">16.00</span><span class="w"> </span><span class="err">Ry</span><span class="w">     </span><span class="err">beta=</span><span class="w"> </span><span class="mf">0.70</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">8.84E-07</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">2.6</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">cpu</span><span class="w"> </span><span class="err">time</span><span class="w"> </span><span class="err">spent</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">now</span><span class="w"> </span><span class="err">is</span><span class="w">        </span><span class="mf">0.4</span><span class="w"> </span><span class="err">secs</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w">              </span><span class="err">=</span><span class="w">     </span><span class="mf">-15.83900178</span><span class="w"> </span><span class="err">Ry</span><span class="w">
</span><span class="err">estimated</span><span class="w"> </span><span class="err">scf</span><span class="w"> </span><span class="err">accuracy</span><span class="w">    </span><span class="err">&lt;</span><span class="w">       </span><span class="mf">0.00000211</span><span class="w"> </span><span class="err">Ry</span><span class="w">

</span><span class="err">iteration</span><span class="w"> </span><span class="err">#</span><span class="w">  </span><span class="mi">5</span><span class="w">     </span><span class="err">ecut=</span><span class="w">    </span><span class="mf">16.00</span><span class="w"> </span><span class="err">Ry</span><span class="w">     </span><span class="err">beta=</span><span class="w"> </span><span class="mf">0.70</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">2.64E-08</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">3.6</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">cpu</span><span class="w"> </span><span class="err">time</span><span class="w"> </span><span class="err">spent</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">now</span><span class="w"> </span><span class="err">is</span><span class="w">        </span><span class="mf">0.4</span><span class="w"> </span><span class="err">secs</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w">              </span><span class="err">=</span><span class="w">     </span><span class="mf">-15.83900299</span><span class="w"> </span><span class="err">Ry</span><span class="w">
</span><span class="err">estimated</span><span class="w"> </span><span class="err">scf</span><span class="w"> </span><span class="err">accuracy</span><span class="w">    </span><span class="err">&lt;</span><span class="w">       </span><span class="mf">0.00000012</span><span class="w"> </span><span class="err">Ry</span><span class="w">

</span><span class="err">iteration</span><span class="w"> </span><span class="err">#</span><span class="w">  </span><span class="mi">6</span><span class="w">     </span><span class="err">ecut=</span><span class="w">    </span><span class="mf">16.00</span><span class="w"> </span><span class="err">Ry</span><span class="w">     </span><span class="err">beta=</span><span class="w"> </span><span class="mf">0.70</span><span class="w">
</span><span class="err">Davidson</span><span class="w"> </span><span class="err">diagonalization</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">overlap</span><span class="w">
</span><span class="err">ethr</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">1.46E-09</span><span class="err">,</span><span class="w">  </span><span class="err">avg</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">iterations</span><span class="w"> </span><span class="err">=</span><span class="w">  </span><span class="mf">2.7</span><span class="w">
</span><span class="err">total</span><span class="w"> </span><span class="err">cpu</span><span class="w"> </span><span class="err">time</span><span class="w"> </span><span class="err">spent</span><span class="w"> </span><span class="err">up</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">now</span><span class="w"> </span><span class="err">is</span><span class="w">        </span><span class="mf">0.4</span><span class="w"> </span><span class="err">secs</span><span class="w">

</span><span class="err">End</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">self-consistent</span><span class="w"> </span><span class="err">calculation</span><span class="w">
</span></code></pre></div></div> <p>Important notes:</p> <ul> <li>The <strong>total energy</strong> depends on the selected pseudopotential.</li> <li>Convergence is achieved in 6 iterations.</li> </ul> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="w">    </span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w">              </span><span class="err">=</span><span class="w">     </span><span class="mf">-15.83900302</span><span class="w"> </span><span class="err">Ry</span><span class="w">
     </span><span class="err">estimated</span><span class="w"> </span><span class="err">scf</span><span class="w"> </span><span class="err">accuracy</span><span class="w">    </span><span class="err">&lt;</span><span class="w">          </span><span class="mf">3.2E-10</span><span class="w"> </span><span class="err">Ry</span><span class="w">

     </span><span class="err">The</span><span class="w"> </span><span class="err">total</span><span class="w"> </span><span class="err">energy</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">sum</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">following</span><span class="w"> </span><span class="err">terms:</span><span class="w">
     </span><span class="err">one-electron</span><span class="w"> </span><span class="err">contribution</span><span class="w"> </span><span class="err">=</span><span class="w">       </span><span class="mf">4.79863652</span><span class="w"> </span><span class="err">Ry</span><span class="w">
     </span><span class="err">hartree</span><span class="w"> </span><span class="err">contribution</span><span class="w">      </span><span class="err">=</span><span class="w">       </span><span class="mf">1.07565897</span><span class="w"> </span><span class="err">Ry</span><span class="w">
     </span><span class="err">xc</span><span class="w"> </span><span class="err">contribution</span><span class="w">           </span><span class="err">=</span><span class="w">      </span><span class="mf">-4.81353993</span><span class="w"> </span><span class="err">Ry</span><span class="w">
     </span><span class="err">ewald</span><span class="w"> </span><span class="err">contribution</span><span class="w">        </span><span class="err">=</span><span class="w">     </span><span class="mf">-16.89975858</span><span class="w"> </span><span class="err">Ry</span><span class="w">

     </span><span class="err">convergence</span><span class="w"> </span><span class="err">has</span><span class="w"> </span><span class="err">been</span><span class="w"> </span><span class="err">achieved</span><span class="w"> </span><span class="err">in</span><span class="w">   </span><span class="mi">6</span><span class="w"> </span><span class="err">iterations</span><span class="w">
</span></code></pre></div></div> <h3 id="tips">Tips</h3> <ul> <li>Reduce <code class="language-plaintext highlighter-rouge">mixing_beta</code> for oscillating convergence.</li> <li>Increase cutoff energies (<code class="language-plaintext highlighter-rouge">ecutwfc</code>, <code class="language-plaintext highlighter-rouge">ecutrho</code>).</li> <li>Use recommended pseudopotentials.</li> <li>Suggested <code class="language-plaintext highlighter-rouge">conv_thr</code> values: <ul> <li>Energy and eigenvalues (SCF): 1.0d-7 Ry.</li> <li>Forces (relax): 1.0e-8 Ry.</li> <li>Stress (vc-relax): 1.0d-9 Ry.</li> </ul> </li> </ul> <h3 id="additional-details">Additional Details</h3> <ul> <li>Exchange-correlation used in the calculation:</li> </ul> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Exchange-correlation=</span><span class="w"> </span><span class="err">SLA</span><span class="w">  </span><span class="err">PZ</span><span class="w">   </span><span class="err">NOGX</span><span class="w"> </span><span class="err">NOGC</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>Total plane waves</strong> used (e.g., 1067):</li> </ul> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">sticks:</span><span class="w">   </span><span class="err">dense</span><span class="w">  </span><span class="err">smooth</span><span class="w">     </span><span class="err">PW</span><span class="w">     </span><span class="err">G-vecs:</span><span class="w">    </span><span class="err">dense</span><span class="w">   </span><span class="err">smooth</span><span class="w">      </span><span class="err">PW</span><span class="w">
</span><span class="err">Sum</span><span class="w">         </span><span class="mi">433</span><span class="w">     </span><span class="mi">433</span><span class="w">    </span><span class="mi">139</span><span class="w">                 </span><span class="mi">5961</span><span class="w">     </span><span class="mi">5961</span><span class="w">    </span><span class="mi">1067</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>Number of Kohn-Sham states</strong>:</li> </ul> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">electrons</span><span class="w">       </span><span class="err">=</span><span class="w">         </span><span class="mf">8.00</span><span class="w">
</span><span class="err">number</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">Kohn-Sham</span><span class="w"> </span><span class="err">states=</span><span class="w">            </span><span class="mi">8</span><span class="w">
</span></code></pre></div></div>]]></content><author><name></name></author><category term="calculation"/><category term="quantum-espresso"/><category term="dft"/><category term="scf"/><category term="electronic-structure"/><summary type="html"><![CDATA[A guide to performing self-consistent field (SCF) calculations using Quantum ESPRESSO, covering input files, execution, and output analysis.]]></summary></entry><entry><title type="html">Microscopic Description of Thermophysics</title><link href="https://lyushisyan.github.io/blog/2023/nano-micro-thermophysics/" rel="alternate" type="text/html" title="Microscopic Description of Thermophysics"/><published>2023-10-08T00:32:13+00:00</published><updated>2023-10-08T00:32:13+00:00</updated><id>https://lyushisyan.github.io/blog/2023/nano-micro-thermophysics</id><content type="html" xml:base="https://lyushisyan.github.io/blog/2023/nano-micro-thermophysics/"><![CDATA[<p>The macroscopic energy conservation equation in heat transfer describes the storage, transport (conduction $k$, convection $u$, and radiation $r$), and conversion of thermal energy into other forms of energy.</p> <h2 id="energy-conservation-equation">Energy Conservation Equation</h2> \[\nabla\cdot \boldsymbol q=-\rho c_p\frac{\partial T}{\partial t}+\sum_{i,j}\dot s_{i-j}, \nabla\cdot \boldsymbol q=\frac{\int_{\Delta A}(\boldsymbol q\cdot\boldsymbol s_{\boldsymbol n})dA}{\Delta V \to 0}\] <p>Here, $\rho c_p\frac{\partial T}{\partial t}$ is referred to as sensible heat storage, and $\dot s_{i-j}$ is the rate of energy conversion due to interactions between energy carriers $i$ and $j$, determined by their properties and frequency of interaction.</p> <p>The heat flux vector $\boldsymbol q$ is the sum of conduction, convection, and radiation heat flux vectors:</p> \[\boldsymbol q = \boldsymbol q_k + \boldsymbol q_u + \boldsymbol q_r\] <p><strong>Conduction heat flux vector</strong> $\boldsymbol q_k$ is the negative product of thermal conductivity $k$ and temperature gradient $\nabla T$, according to Fourier’s law:</p> \[\boldsymbol q_k = -k\nabla T\] <p><strong>Convection heat flux vector</strong> $\boldsymbol q_u$ is the product of $\rho c_p$, local velocity vector $\boldsymbol u$, and temperature $T$:</p> \[\boldsymbol q_u = \rho c_p\boldsymbol u T\] <p><strong>Radiative heat flux vector</strong> $\boldsymbol q_r$ is the integral over space and electromagnetic spectrum of the product of unit vector $\boldsymbol s$ and directional spectral intensity $I_{ph,\omega}$:</p> \[\boldsymbol q_r = 2\pi\int_0^\infty\int_{-1}^1\boldsymbol s I_{ph,\omega}d\mu d\omega\] <h2 id="primary-energy-carriers">Primary Energy Carriers</h2> <p>Four types of energy carriers—<strong>phonons</strong> ($p$), <strong>electrons</strong> ($e$), <strong>fluid particles</strong> ($f$), and <strong>photons</strong> ($ph$)—form the microscopic basis for thermal energy storage, transport, and interaction.</p> <h3 id="phonons">Phonons</h3> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/thermophysics_1-480.webp 480w,/assets/img/blog/thermophysics_1-800.webp 800w,/assets/img/blog/thermophysics_1-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/thermophysics_1.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure 1: Phonons</figcaption> </figure> </div> <ul> <li>Phonons are quantized vibrational modes in a rigid atomic lattice.</li> <li>Long-wavelength phonons cause sound propagation in solids, hence the name “phonons.”</li> <li>Phonons determine many physical properties of materials, including heat capacity and thermal/electrical conductivity (phonons transport heat in insulators).</li> <li>In classical mechanics, lattice vibrations decompose into nonlocal normal modes.</li> <li>Quantum mechanically, these modes exhibit particle-like behavior—hence phonons are <strong>quasiparticles</strong>.</li> <li>As particles, phonons are <strong>bosons</strong> with zero spin, and their energy $E_p=\hbar\omega_p$ is the sum of kinetic and potential energies.</li> <li>Phonons come in two types: <strong>acoustic</strong> ($A$) and <strong>optical</strong> ($O$).</li> <li>Acoustic phonons decrease in frequency with increasing wavelength and correspond to lattice sound waves. Longitudinal and transverse types are abbreviated $LA$ and $TA$.</li> <li>Optical phonons arise in lattices with multiple atoms per unit cell and are excited by light in ionic crystals: $LO$ and $TO$ indicate longitudinal and transverse types.</li> </ul> <h3 id="electrons">Electrons</h3> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/thermophysics_2-480.webp 480w,/assets/img/blog/thermophysics_2-800.webp 800w,/assets/img/blog/thermophysics_2-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/thermophysics_2.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure 2: Electrons</figcaption> </figure> </div> <ul> <li>Electrons are negatively charged <strong>subatomic particles</strong> with spin $1/2$—they are <strong>fermions</strong>.</li> <li>The electron’s antiparticle is the <strong>positron</strong>, with the same mass and spin but opposite charge.</li> <li>Electrons exhibit both wave and particle properties, making them <strong>quasiparticles</strong>.</li> <li>Bound electrons appear as <strong>standing waves</strong>, observable experimentally.</li> <li>Electrons in solids include core and outer electrons. Core electrons are tightly bound and do not participate in bonding.</li> <li>Outer electrons, including <strong>conduction</strong> and <strong>valence</strong> electrons, are farther from the nucleus.</li> <li>Quantum mechanically, electrons are described by the <strong>Dirac equation</strong>.</li> <li>Their energy includes potential energy (binding energy) and kinetic energy (velocity-related).</li> </ul> <h3 id="fluid-particles">Fluid Particles</h3> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/thermophysics_3-480.webp 480w,/assets/img/blog/thermophysics_3-800.webp 800w,/assets/img/blog/thermophysics_3-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/thermophysics_3.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure 3: Fluid Particles</figcaption> </figure> </div> <ul> <li>Gases and liquids consist of atoms or molecules (fluid particles), which can be neutral or charged and are in <strong>random motion</strong>.</li> <li>Their energy includes potential, electronic, and kinetic components.</li> <li>In <strong>ideal gases</strong>, particle collisions are <strong>elastic</strong>, and intermolecular forces are negligible.</li> <li>Maxwell–Boltzmann distribution for ideal gases can be derived via statistical mechanics and energy symmetry principles.</li> <li>Liquid particles have sufficient kinetic energy to stretch but not overcome intermolecular forces. As temperature rises, they gain enough energy to become gases.</li> </ul> <h3 id="photons">Photons</h3> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/thermophysics_4-480.webp 480w,/assets/img/blog/thermophysics_4-800.webp 800w,/assets/img/blog/thermophysics_4-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/blog/thermophysics_4.png" class="w-75" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <figcaption class="caption">Figure 4: Photons</figcaption> </figure> </div> <ul> <li>Photons are quantum excitations of the electromagnetic field and are part of the Standard Model of particle physics.</li> <li>Quantum mechanically, photons exhibit wave properties.</li> <li>Although photons have <strong>zero rest mass</strong>, they carry finite energy and are affected by gravity (relativity).</li> <li>Photons are <strong>bosons</strong> with spin 1 and exhibit circular polarization.</li> <li>Electromagnetic fields consist of <strong>monochromatic plane waves</strong> characterized by frequency $f_{ph}$, wavelength $\lambda_{ph}$, and speed $u_{ph}$.</li> <li>Quantum energy: $E_{ph} = \hbar \omega_{ph}$; momentum: $\boldsymbol p_{ph} = \hbar \boldsymbol\kappa_{ph}$.</li> <li>In vacuum, photon dispersion is linear—proportional to <strong>Planck’s constant</strong>.</li> <li>Matter excitations have nonlinear dispersion, so they travel slower than light.</li> </ul> <h2 id="energy-distribution-function">Energy Distribution Function</h2> <p>In multi-particle systems, the observed <strong>macroscopic state</strong> (ensemble average) is linked to each particle’s <strong>microscopic state</strong> (position and momentum) through the probability of occurrence (energy distribution function):</p> \[\left \langle \phi \right \rangle=\sum_if_i\phi_i\] <p>Probability distribution functions determine carrier energy and transport characteristics. They allow modeling of temperature-dependent lattice and electronic heat capacity, gas kinetic energy, and blackbody radiation.</p> <p>Equilibrium distribution $f_i^0$ describes the most likely distribution of microstates in the absence of perturbations:</p> <ul> <li><strong>Bose–Einstein distribution</strong> (phonons, photons)</li> </ul> \[f_i^0 = \frac{1}{\exp(\frac{E_i}{k_\text BT})-1}\] <ul> <li><strong>Fermi–Dirac distribution</strong> (electrons)</li> </ul> \[f_i^0 = \frac{1}{\exp(\frac{E_i-\mu}{k_\text BT})+1}\] <ul> <li><strong>Maxwell–Boltzmann distribution</strong> (ideal gas molecules)</li> </ul> \[f_i^0 = \frac{1}{\exp(\frac{E_i}{k_\text BT})}\] <p>Deviations from equilibrium underpin carrier transport—<strong>Boltzmann transport theory</strong>.</p> <h2 id="particles-waves-and-quasiparticles">Particles, Waves, and Quasiparticles</h2> <h3 id="particles">Particles</h3> <p>Particles are <strong>discrete</strong>; their energy is localized in finite regions. To reach different positions, particles must move according to kinematic laws.</p> <p>Interactions follow simple rules like conservation of energy and momentum in elastic collisions. When unperturbed, particles move <strong>ballistically</strong>.</p> <h3 id="waves">Waves</h3> <p>Waves are not finite entities. Their energy is distributed across space and time. Waves propagate indefinitely, with phase analysis revealing their speed. Waves are described by frequency and wavelength.</p> <h3 id="quasiparticles">Quasiparticles</h3> <p>Quasiparticles (phonons, electrons, photons) exhibit both particle and wave nature and are described as wave packets—a superposition of plane waves with different wavelengths.</p> <p>This dual nature is called <strong>wave–particle duality</strong>.</p> <p>The classical distinction between particles and waves blurs for quasiparticles. Their behavior is part wave theory, part particle theory.</p> <h2 id="contributions-to-heat-transfer-physics">Contributions to Heat Transfer Physics</h2> <p>Heat is a form of energy manifested as molecular motion and is transferred between bodies via <strong>conduction</strong> (phonons, electrons, fluid particles), <strong>convection</strong> (fluid particles), and <strong>radiation</strong> (photons).</p> <p>Key physical foundations:</p> <ul> <li><strong>Boltzmann</strong>: Proposed that heat capacity, entropy, and thermodynamics arise from atomic motion; introduced Boltzmann constant $k_B$ and co-developed energy equipartition theorem.</li> <li><strong>Maxwell</strong>: Founded electromagnetic theory of light; contributed to kinetic gas theory, molecular physics, thermodynamics.</li> <li><strong>Planck</strong>: Discovered energy is <strong>quantized</strong>, postulating discrete energy quanta $h\nu$.</li> <li><strong>Bohr</strong>: Suggested atoms absorb/emit quantum energy matching energy level differences.</li> <li><strong>Pauli</strong>: Formulated <strong>Pauli exclusion principle</strong>: no two electrons can occupy the same state.</li> <li><strong>Schrödinger</strong>: Derived wave function (probability wave) equation foundational to <strong>quantum wave mechanics</strong>.</li> <li><strong>Fermi</strong>: Developed method (with Dirac) for particles following Pauli principle—<strong>Fermi statistics</strong>.</li> <li><strong>Green &amp; Kubo</strong>: Developed <strong>fluctuation–dissipation theorem</strong> for transport coefficients.</li> <li><strong>Ziman</strong>: Applied variational method to phonon transport.</li> <li><strong>Callaway &amp; Holland</strong>: Modeled lattice thermal conductivity via <strong>single-mode relaxation time</strong>.</li> </ul> <h2 id="fundamental-constants-and-fine-structure-scale">Fundamental Constants and Fine Structure Scale</h2> <h3 id="boltzmann-constant">Boltzmann Constant</h3> \[k_\text B=1.38065\times10^{-23} ~ \text J/\text K\] <p>Relates mean thermal energy of carriers (phonons, electrons, photons, fluids) to absolute temperature $T$.</p> <p>Used to normalize carrier energy: $k_\text BT$.</p> <p>In statistical mechanics: entropy $S=k_\text BN\ln Z$, with $Z$ as the partition function.</p> <p>In kinetic theory: each degree of freedom has energy $k_\text BT/2$ (equipartition).</p> <h3 id="planck-constant">Planck Constant</h3> \[h=6.626069\times10^{−34} ~ \text J\cdot \text s\] <p>In quantum mechanics: energy = frequency $\times$ $h$.</p> <p>Reduced Planck constant: $\hbar = h/2\pi$.</p> <p>Quantizes physical properties and appears in Heisenberg uncertainty principle: $\Delta p_x \Delta x \le \hbar/2$.</p> <h3 id="atomic-units">Atomic Units</h3> <p>Four constants define atomic units: $\hbar$, $m_e$, Coulomb constant $1/4\pi\varepsilon_0$, electron charge $e_c$.</p> <ul> <li>Atomic length:</li> </ul> \[r_\text B = \frac{4\pi\varepsilon_0\hbar^2}{m_e e_c^2}=5.2918\times 10^{-11}~ \text m\] <ul> <li>Atomic time:</li> </ul> \[\tau_a=\frac{m_er_\text B^2}{\hbar} = 2.4189\times 10^{-17} ~ \text s\] <ul> <li>Atomic energy:</li> </ul> \[\frac{e_c^2}{4\pi\varepsilon_0r_\text B}=4.3597\times10^{-18}\text J=27.211~ \text{eV}\] <ul> <li>Atomic velocity:</li> </ul> \[\frac{r_\text B}{\tau_a} = 2.1877 \times 10^6~ \text m/\text s\] <ul> <li>Atomic dipole moment:</li> </ul> \[e_cr_\text B=8.4783\times 10^{-30}~ \text C\cdot\text m\] <hr/> <p><strong>References:</strong></p> <p>Kaviany M. <em>Heat Transfer Physics</em>, 2008</p>]]></content><author><name></name></author><category term="physics"/><category term="heat-transfer"/><category term="physics"/><category term="thermodynamics"/><category term="microscopic"/><summary type="html"><![CDATA[A microscopic view of heat transfer, covering energy carriers, distribution functions, and fundamental constants.]]></summary></entry></feed>